<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2024-08-31">

<title>we could go anywhere - Hands-on Exercise 8: Geographically Weighted Predictive Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../Images/Icon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script src="../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="../../site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="../../site_libs/datatables-binding-0.31/datatables.js"></script>
<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="../../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="../../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="../../site_libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="../../site_libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="../../site_libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="../../site_libs/selectize-0.12.0/selectize.min.js"></script>
<link href="../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../Images/logo.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Hands-on Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercises">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01a.html" rel="" target="">
 <span class="dropdown-text">1a Geospatial Data Wrangling</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01b.html" rel="" target="">
 <span class="dropdown-text">1b Choropleth Mapping</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02a.html" rel="" target="">
 <span class="dropdown-text">2a 1st Order Spatial Point Patterns Analysis Methods</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02b.html" rel="" target="">
 <span class="dropdown-text">2b 2nd Order Spatial Point Patterns Analysis Methods</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03.html" rel="" target="">
 <span class="dropdown-text">3 Network Constrained Spatial Point Patterns Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04.html" rel="" target="">
 <span class="dropdown-text">4 Spatial Weights and Applications</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05a.html" rel="" target="">
 <span class="dropdown-text">5a Global Measures of Spatial Autocorrelation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05b.html" rel="" target="">
 <span class="dropdown-text">5b Lobal Measures of Spatial Autocorrelation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex06/Hands-on_Ex06.html" rel="" target="">
 <span class="dropdown-text">6 Geographical Segmentation with Spatially Constrained Clustering Techniques</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07.html" rel="" target="">
 <span class="dropdown-text">7 Calibrating Hedonic Pricing Model</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex08/Hands-on_Ex08.html" rel="" target="">
 <span class="dropdown-text">8 Geographically Weighted Predictive Models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex09/Hands-on_Ex09a.html" rel="" target="">
 <span class="dropdown-text">9a Processing and Visualising Flow Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex09/Hands-on_Ex09b.html" rel="" target="">
 <span class="dropdown-text">9b Calibrating Spatial Interaction Models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex10/Hands-on_Ex10.html" rel="" target="">
 <span class="dropdown-text">10 Modelling Geographical Accessibility</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">In-class Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercises">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex01/In-class_Ex01.html" rel="" target="">
 <span class="dropdown-text">1/</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex02/In-class_Ex02.html" rel="" target="">
 <span class="dropdown-text">2/</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex03/In-class_Ex03.html" rel="" target="">
 <span class="dropdown-text">3/</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex04/In-class_Ex04.html" rel="" target="">
 <span class="dropdown-text">4/</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex05/In-class_Ex05.html" rel="" target="">
 <span class="dropdown-text">5/</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex06/In-class_Ex06.html" rel="" target="">
 <span class="dropdown-text">6/</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex07/In-class_Ex07.html" rel="" target="">
 <span class="dropdown-text">7/</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex08/In-class_Ex08.html" rel="" target="">
 <span class="dropdown-text">8/</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex09/In-class_Ex09.html" rel="" target="">
 <span class="dropdown-text">9/</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex10/In-class_Ex10.html" rel="" target="">
 <span class="dropdown-text">10/</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Take-home Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercises">    
        <li>
    <a class="dropdown-item" href="../../Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.html" rel="" target="">
 <span class="dropdown-text">1/</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-Home_Ex/Take-Home_Ex02/Take-Home_Ex02.html" rel="" target="">
 <span class="dropdown-text">2/</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-Home_Ex/Take-Home_Ex03/Take-Home_Ex03.html" rel="" target="">
 <span class="dropdown-text">3/</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text"><i class="fa-solid fa-house fa-lg" aria-label="house"></i></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text"><i class="fa-solid fa-at fa-lg" aria-label="at"></i></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Hands-on Exercise 8: Geographically Weighted Predictive Models</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">August 31, 2024</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">September 1, 2024</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">1 Overview</a></li>
  <li><a href="#the-packages" id="toc-the-packages" class="nav-link" data-scroll-target="#the-packages">2 The Packages</a></li>
  <li><a href="#the-data" id="toc-the-data" class="nav-link" data-scroll-target="#the-data">3 The Data</a></li>
  <li><a href="#data-sampling" id="toc-data-sampling" class="nav-link" data-scroll-target="#data-sampling">4 Data Sampling</a></li>
  <li><a href="#computing-correlation-matrix" id="toc-computing-correlation-matrix" class="nav-link" data-scroll-target="#computing-correlation-matrix">5 Computing Correlation Matrix</a></li>
  <li><a href="#non-spatial-multiple-linear-regression" id="toc-non-spatial-multiple-linear-regression" class="nav-link" data-scroll-target="#non-spatial-multiple-linear-regression">6 Non-spatial multiple linear regression</a></li>
  <li><a href="#gwr-prediction" id="toc-gwr-prediction" class="nav-link" data-scroll-target="#gwr-prediction">7 GWR Prediction</a>
  <ul>
  <li><a href="#converting-sf-data-frame-to-spatialpointdataframe" id="toc-converting-sf-data-frame-to-spatialpointdataframe" class="nav-link" data-scroll-target="#converting-sf-data-frame-to-spatialpointdataframe">7.1 Converting sf data frame to SPatialPointDataFrame</a></li>
  <li><a href="#compute-adaptive-bandwidth" id="toc-compute-adaptive-bandwidth" class="nav-link" data-scroll-target="#compute-adaptive-bandwidth">7.2 Compute adaptive bandwidth</a></li>
  <li><a href="#construct-adaptive-bandwidth-gwr-model" id="toc-construct-adaptive-bandwidth-gwr-model" class="nav-link" data-scroll-target="#construct-adaptive-bandwidth-gwr-model">7.3 Construct adaptive bandwidth GWR model</a></li>
  <li><a href="#retrieve-gwr-output-object" id="toc-retrieve-gwr-output-object" class="nav-link" data-scroll-target="#retrieve-gwr-output-object">7.4 Retrieve GWR output object</a></li>
  <li><a href="#convert-test-data-from-sf-data-frame-to-spatialpointdataframe" id="toc-convert-test-data-from-sf-data-frame-to-spatialpointdataframe" class="nav-link" data-scroll-target="#convert-test-data-from-sf-data-frame-to-spatialpointdataframe">7.5 Convert test data from sf data frame to SpatialPointDataFrame</a></li>
  <li><a href="#computing-adaptive-bandwidth-for-test-data" id="toc-computing-adaptive-bandwidth-for-test-data" class="nav-link" data-scroll-target="#computing-adaptive-bandwidth-for-test-data">7.6 Computing adaptive bandwidth for test data</a></li>
  <li><a href="#computing-predicted-values-of-the-test-data" id="toc-computing-predicted-values-of-the-test-data" class="nav-link" data-scroll-target="#computing-predicted-values-of-the-test-data">7.7 Computing predicted values of the test data</a></li>
  </ul></li>
  <li><a href="#preparing-coordinates-data" id="toc-preparing-coordinates-data" class="nav-link" data-scroll-target="#preparing-coordinates-data">8 Preparing coordinates data</a>
  <ul>
  <li><a href="#extracting-coordinates-data" id="toc-extracting-coordinates-data" class="nav-link" data-scroll-target="#extracting-coordinates-data">8.1 Extracting coordinates data</a></li>
  <li><a href="#dropping-geometry-field" id="toc-dropping-geometry-field" class="nav-link" data-scroll-target="#dropping-geometry-field">8.2 Dropping geometry field</a></li>
  </ul></li>
  <li><a href="#calibrating-random-forest-model" id="toc-calibrating-random-forest-model" class="nav-link" data-scroll-target="#calibrating-random-forest-model">9 Calibrating Random Forest Model</a></li>
  <li><a href="#calibrating-geographical-random-forest-model" id="toc-calibrating-geographical-random-forest-model" class="nav-link" data-scroll-target="#calibrating-geographical-random-forest-model">10 Calibrating Geographical Random Forest Model</a>
  <ul>
  <li><a href="#calibrating-using-training-data" id="toc-calibrating-using-training-data" class="nav-link" data-scroll-target="#calibrating-using-training-data">10.1 Calibrating using training data</a></li>
  <li><a href="#predicting-by-using-test-data" id="toc-predicting-by-using-test-data" class="nav-link" data-scroll-target="#predicting-by-using-test-data">10.2 Predicting by using test data</a>
  <ul class="collapse">
  <li><a href="#preparing-the-test-data" id="toc-preparing-the-test-data" class="nav-link" data-scroll-target="#preparing-the-test-data">10.2.1 Preparing the test data</a></li>
  <li><a href="#predicting-with-test-data" id="toc-predicting-with-test-data" class="nav-link" data-scroll-target="#predicting-with-test-data">10.2.2 Predicting with test data</a></li>
  <li><a href="#converting-predictive-output-into-data-frame" id="toc-converting-predictive-output-into-data-frame" class="nav-link" data-scroll-target="#converting-predictive-output-into-data-frame">10.2.3 Converting predictive output into data frame</a></li>
  </ul></li>
  <li><a href="#calculating-root-mean-square-error-rmse" id="toc-calculating-root-mean-square-error-rmse" class="nav-link" data-scroll-target="#calculating-root-mean-square-error-rmse">10.3 Calculating Root Mean Square Error (RMSE)</a></li>
  <li><a href="#visualising-predicted-values" id="toc-visualising-predicted-values" class="nav-link" data-scroll-target="#visualising-predicted-values">10.4 Visualising Predicted Values</a></li>
  </ul></li>
  <li><a href="#reference" id="toc-reference" class="nav-link" data-scroll-target="#reference">11 Reference</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="overview" class="level1">
<h1>1 Overview</h1>
<p>Predictive modelling utilises statistical or machine learning techniques to predict outcomes. A set of known outcomes and predictors are used to calibrate predictive models.</p>
<p>Geospatial predictive modelling is conceptually rooted in the principle that the occurrences of events being modeled are limited in distribution. When geographically referenced data are used, occurrences of events are neither uniform nor random in distribution over space. There are geospatial factors (infrastructure, sociocultural, topographic, etc.) that constrain and influence where the locations of events occur. Geospatial predictive modeling attempts to describe those constraints and influences by spatially correlating occurrences of historical geospatial locations with environmental factors that represent those constraints and influences.</p>
<div class="sherbox sherlock">
<p><strong>Learning Outcome</strong></p>
<p>This exercise aims to build predictive models using geographical random forest. Along the way, the intended acquired skills are:</p>
<ul>
<li><p>Preparing training and test data sets using sampling methods</p></li>
<li><p>Calibrating predictive models using both geospatial statistical learning and machine learning methods</p></li>
<li><p>Comparing and selecting the best model for predicting the future outcome and,</p></li>
<li><p>Predicting future outcomes using the best calibrated model</p></li>
</ul>
</div>
</section>
<section id="the-packages" class="level1">
<h1>2 The Packages</h1>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Packages</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Code</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<table class="table">
<colgroup>
<col style="width: 20%">
<col style="width: 80%">
</colgroup>
<thead>
<tr class="header">
<th>Package</th>
<th>Usage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="https://cran.r-project.org/web/packages/sf/index.html"><strong>sf</strong></a><strong>,</strong></td>
<td>For spatial data handling</td>
</tr>
<tr class="even">
<td><a href="https://r-spatial.github.io/spdep/reference/index.html"><strong>spdep</strong></a></td>
<td>For spatial data analysis</td>
</tr>
<tr class="odd">
<td><a href="https://cran.r-project.org/web/packages/GWmodel/"><strong>GWmodel</strong></a></td>
<td>For calibrating geographical weighted family of models</td>
</tr>
<tr class="even">
<td><a href="https://cran.r-project.org/web/packages/SpatialML/index.html"><strong>SpatialML</strong></a></td>
<td>For geographically weighted random forest regression</td>
</tr>
<tr class="odd">
<td><a href="https://rsample.tidymodels.org/"><strong>rsample</strong></a></td>
<td>For creating and analysing resamples of a data set</td>
</tr>
<tr class="even">
<td><a href="https://github.com/mfrasco/Metrics"><strong>Metrics</strong></a></td>
<td>For machine learning metrics</td>
</tr>
<tr class="odd">
<td><a href="https://cran.r-project.org/web/packages/tmap/"><strong>tmap</strong></a></td>
<td>Choropleth mapping; thematic maps</td>
</tr>
<tr class="even">
<td><a href="https://www.tidyverse.org/"><strong>tidyverse</strong></a></td>
<td>Attribute data handling</td>
</tr>
<tr class="odd">
<td><a href="https://rstudio.github.io/DT/"><strong>DT</strong></a>, <a href="https://yihui.org/knitr/"><strong>knitr</strong></a>, <a href="https://haozhu233.github.io/kableExtra/"><strong>kableExtra</strong></a></td>
<td>For building tables</td>
</tr>
</tbody>
</table>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(sf, spdep, </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               GWmodel, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               SpatialML, </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>               rsample, </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>               Metrics,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>               tmap, </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>               tidyverse,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>               DT, knitr, kableExtra, gtsummary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="the-data" class="level1">
<h1>3 The Data</h1>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Sources</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Data Import</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>Two data sets will be used in this hands-on exercise, they are:</p>
<table class="table">
<colgroup>
<col style="width: 10%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 30%">
<col style="width: 30%">
</colgroup>
<thead>
<tr class="header">
<th>Type</th>
<th>Name</th>
<th>Source</th>
<th>Details</th>
<th>Screenshot</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Aspatial</td>
<td><a href="https://data.gov.sg/datasets?query=hdb+resale&amp;page=1&amp;resultId=d_8b84c4ee58e3cfc0ece0d773c8ca6abc">HDB Resale data</a></td>
<td>data.gov.sg</td>
<td><ul>
<li><p>List of HDB resale transacted prices in Singapore from Jan 2017 onwards</p></li>
<li><p>Format: csv</p></li>
</ul></td>
<td><img src="images/hdbresale.PNG" class="img-fluid" width="200"></td>
</tr>
<tr class="even">
<td>Geospatial</td>
<td><a href="https://beta.data.gov.sg/datasets?query=Master+Plan+2014+Subzone+Boundary+%28Web%29&amp;resultId=d_d14da225fccf921049ab64238ff473d9">Master Plan 2014 Subzone Boundary Web</a></td>
<td>data.gov.sg</td>
<td><ul>
<li><p>Polygon feature data providing information of URA 2014 Master Plan Planning Subzone boundary data</p></li>
<li><p>Format: SHP (ESRI Shapefile)</p></li>
</ul></td>
<td><img src="images/MPSZ_SHP.PNG" class="img-fluid" width="200"></td>
</tr>
<tr class="odd">
<td>Locational factors with geographic coordinates</td>
<td><a href="https://data.gov.sg/datasets?query=eldercare&amp;page=1&amp;resultId=d_3545b068e3f3506c56b2cb6b6117b884">Eldercare Services</a></td>
<td>data.gov.sg</td>
<td><ul>
<li><p>List of eldercare in Singapore</p></li>
<li><p>Format: SHP (ESRI Shapefile)</p></li>
</ul></td>
<td><img src="images/eldercare.PNG" width="200" height="95"></td>
</tr>
<tr class="even">
<td>Locational factors with geographic coordinates</td>
<td><a href="https://data.gov.sg/datasets?query=hawker+centre&amp;page=1&amp;resultId=d_4a086da0a5553be1d89383cd90d07ecd">Hawker Centers</a></td>
<td>data.gov.sg</td>
<td><ul>
<li><p>List of hawker centres in Singapore</p></li>
<li><p>Format: geojson</p></li>
</ul></td>
<td><img src="images/hawkercentres.PNG" class="img-fluid" width="200"></td>
</tr>
<tr class="odd">
<td>Locational factors with geographic coordinates</td>
<td><a href="https://data.gov.sg/datasets?query=parks&amp;page=1&amp;resultId=d_0542d48f0991541706b58059381a6eca">Parks</a></td>
<td>data.gov.sg</td>
<td><ul>
<li><p>List of parks in Singapore</p></li>
<li><p>Format: geojson</p></li>
</ul></td>
<td><img src="images/parks.PNG" class="img-fluid" width="200"></td>
</tr>
<tr class="even">
<td>Locational factors with geographic coordinates</td>
<td><a href="https://data.gov.sg/datasets?query=supermarket&amp;page=1&amp;resultId=d_cac2c32f01960a3ad7202a99c27268a0">Supermarket</a>s</td>
<td>data.gov.sg</td>
<td><ul>
<li><p>List of supermarkets in Singapore</p></li>
<li><p>Format: geojson</p></li>
</ul></td>
<td><img src="images/supermarkets.PNG" width="200" height="110"></td>
</tr>
<tr class="odd">
<td>Locational factors with geographic coordinates</td>
<td><a href="https://data.gov.sg/datasets?query=chas+clinics&amp;page=1&amp;resultId=d_548c33ea2d99e29ec63a7cc9edcccedc">CHAS Clinics</a></td>
<td>data.gov.sg</td>
<td><ul>
<li><p>List of CHAS clinics in Singapore</p></li>
<li><p>Format: geojson</p></li>
</ul></td>
<td><img src="images/chasclinics.PNG" class="img-fluid" width="200"></td>
</tr>
<tr class="even">
<td>Locational factors with geographic coordinates</td>
<td><a href="https://data.gov.sg/datasets?query=childcare+services&amp;page=1&amp;resultId=d_5d668e3f544335f8028f546827b773b4">Childcare Service</a></td>
<td>data.gov.sg</td>
<td><ul>
<li><p>List of childcare services in Singapore</p></li>
<li><p>Format: geojson</p></li>
</ul></td>
<td><img src="images/childcareservices.PNG" class="img-fluid" width="200"></td>
</tr>
<tr class="odd">
<td>Locational factors with geographic coordinates</td>
<td><a href="https://data.gov.sg/datasets?query=kindergartens&amp;page=1&amp;resultId=d_7fe9a72b1afff18e48111772c8d0fd39">Kindergartens</a></td>
<td>data.gov.sg</td>
<td><ul>
<li><p>List of kindergartens in Singapore</p></li>
<li><p>Format: geojson</p></li>
</ul></td>
<td><img src="images/kindergartens.PNG" class="img-fluid" width="200"></td>
</tr>
<tr class="even">
<td>Locational factors with geographic coordinates</td>
<td><a href="https://datamall.lta.gov.sg/content/datamall/en/static-data.html">Train Station</a></td>
<td>datamall.lta.gov.sg</td>
<td><ul>
<li><p>List of MRT/LRT stations in Singapore with station names and codes</p></li>
<li><p>Format: SHP (ESRI Shapefile)</p></li>
</ul></td>
<td><img src="images/trainstations.PNG" class="img-fluid" width="200"></td>
</tr>
<tr class="odd">
<td>Locational factors with geographic coordinates</td>
<td><a href="https://datamall.lta.gov.sg/content/datamall/en/static-data.html">Bus Stop Location</a></td>
<td>datamall.lta.gov.sg</td>
<td><ul>
<li><p>List of bus stops in Singapore</p></li>
<li><p>Format: SHP (ESRI Shapefile)</p></li>
</ul></td>
<td><img src="images/busstops.PNG" class="img-fluid" width="200"></td>
</tr>
<tr class="even">
<td>Locational factors without geographic coordinates</td>
<td><a href="https://data.gov.sg/datasets?query=primary+school&amp;page=1&amp;resultId=d_688b934f82c1059ed0a6993d2a829089">Primary School</a></td>
<td>data.gov.sg</td>
<td><ul>
<li><p>List of General Information of Schools</p></li>
<li><p>Format: CSV</p></li>
</ul></td>
<td><img src="images/primaryschools.PNG" class="img-fluid" width="200"></td>
</tr>
<tr class="odd">
<td>Locational factors without geographic coordinates</td>
<td>CBD Coordinates</td>
<td>Google</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Locational factors without geographic coordinates</td>
<td>Shopping Malls</td>
<td>Wikipedia</td>
<td><ul>
<li>List of shopping malls in Singapore</li>
</ul></td>
<td></td>
</tr>
<tr class="odd">
<td>Locational factors without geographic coordinates</td>
<td><a href="https://www.salary.sg/2021/best-primary-schools-2021-by-popularity">Good Primary Schools</a></td>
<td>Local Salary Forum</td>
<td><ul>
<li><p>List of primary schools, ordered / ranked in by popularity</p></li>
<li><p>Format: CSV</p></li>
</ul></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>mdata <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/aspatial/mdata.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>mdata</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 15901 features and 17 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 11597.31 ymin: 28217.39 xmax: 42623.63 ymax: 48741.06
Projected CRS: SVY21 / Singapore TM
# A tibble: 15,901 × 18
   resale_price floor_area_sqm storey_order remaining_lease_mths PROX_CBD
          &lt;dbl&gt;          &lt;dbl&gt;        &lt;int&gt;                &lt;dbl&gt;    &lt;dbl&gt;
 1       330000             92            1                  684     8.82
 2       360000             91            3                  738     9.84
 3       370000             92            1                  733     9.56
 4       375000             99            2                  700     9.61
 5       380000             92            2                  715     8.35
 6       380000             92            4                  732     9.49
 7       385000             92            3                  706     8.96
 8       395000             92            2                  745     9.81
 9       395000             93            4                  731    10.3 
10       395000             91            3                  725    10.4 
# ℹ 15,891 more rows
# ℹ 13 more variables: PROX_ELDERLYCARE &lt;dbl&gt;, PROX_HAWKER &lt;dbl&gt;,
#   PROX_MRT &lt;dbl&gt;, PROX_PARK &lt;dbl&gt;, PROX_GOOD_PRISCH &lt;dbl&gt;, PROX_MALL &lt;dbl&gt;,
#   PROX_CHAS &lt;dbl&gt;, PROX_SUPERMARKET &lt;dbl&gt;, WITHIN_350M_KINDERGARTEN &lt;int&gt;,
#   WITHIN_350M_CHILDCARE &lt;int&gt;, WITHIN_350M_BUS &lt;int&gt;,
#   WITHIN_1KM_PRISCH &lt;int&gt;, geometry &lt;POINT [m]&gt;</code></pre>
</div>
</div>
<p>Code chunk below shows a preview of the top 200 records:</p>
<div class="cell">
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item" id="htmlwidget-e6a57143bb3ee174a716" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-e6a57143bb3ee174a716">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"270000\" data-max=\"925000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"75\" data-max=\"128\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"11\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"637\" data-max=\"1140\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1.26416811074482\" data-max=\"17.4095672702416\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.034259139296338\" data-max=\"2.4081868956867\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.046380672523336\" data-max=\"2.7063541280834\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.047162890615573\" data-max=\"1.46264569626186\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.115249475823685\" data-max=\"1.91315012862881\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.114661176656617\" data-max=\"8.05639341922882\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.084185922180086\" data-max=\"2.25269448786787\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"7.183371e-09\" data-max=\"0.79249074802552\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1.059035918e-06\" data-max=\"0.87499336784044\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"4\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"9\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"2\" data-max=\"17\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"5\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200"],[330000,360000,370000,375000,380000,380000,385000,395000,395000,395000,400000,408000,409000,412000,428000,460000,463000,490000,500000,598000,750000,338000,345000,348000,350000,350000,350000,353000,358000,365000,370000,375000,380000,382000,385000,385000,385000,390000,390000,390000,396500,405000,418000,420000,422000,431000,435000,440000,545000,630000,650000,680000,690000,720000,750000,468888,470000,478000,500000,505000,515000,525000,530000,535000,548000,548000,550000,550000,560000,565000,568000,568000,600000,610000,614000,618000,625000,630000,648000,818000,820000,305000,310000,314000,330000,330000,335000,338800,340000,355000,365000,370000,370000,378000,380000,380000,385000,388000,413888,430000,435000,442000,446000,452000,362500,408000,412000,475000,480000,510000,605000,614000,643000,668000,708000,715800,793988,838000,842000,850000,270000,295000,320000,330000,335000,336000,340000,345000,349000,350000,350000,358000,375000,380000,388000,400000,410000,412000,450000,462000,480000,483088,533000,545000,580000,445000,550000,570000,800000,840000,925000,295000,295000,308000,310000,310000,312000,315000,318000,318000,320000,323000,326000,330000,335000,335000,337000,340000,340000,340888,343000,345000,352000,355000,355000,355000,358000,360000,365000,368000,370000,380000,400000,411000,420000,365000,400000,418000,430000,430000,460000,462000,470000,500000,520000,570000,604000,680000,680000,685000],[92,91,92,99,92,92,92,92,93,91,91,98,92,95,91,98,92,112,94,90,96,90,91,92,92,84,84,84,84,92,84,84,83,92,104,92,98,91,91,91,83,92,92,91,92,92,104,108,105,92,92,94,94,97,97,93,84,84,84,84,103,84,103,106,104,103,103,114,83,83,104,105,103,102,112,103,104,102,116,95,95,84,104,103,93,103,84,103,93,94,104,104,103,104,102,90,90,105,103,103,103,90,107,128,82,82,88,98,99,91,100,100,90,92,90,90,100,100,93,95,84,84,102,103,103,91,90,103,102,104,93,103,106,99,90,93,101,93,93,93,93,101,91,89,89,75,102,83,94,94,93,90,90,91,90,104,91,106,103,100,90,100,104,103,104,114,104,104,107,108,100,104,103,106,107,102,104,104,105,111,103,92,105,92,92,91,92,92,97,97,83,92,97,91,86,92,85,100,90,90],[1,3,1,2,2,4,3,2,4,3,3,3,4,3,2,5,5,4,2,4,9,3,1,3,3,1,2,4,4,3,3,5,2,2,2,4,3,5,3,3,4,1,3,1,5,4,2,1,4,7,7,2,5,6,4,2,3,3,3,4,3,3,2,2,2,2,2,2,4,4,3,1,3,5,3,2,3,6,4,10,11,2,1,4,2,2,2,1,3,2,3,2,4,4,2,3,2,3,7,5,1,9,3,3,4,4,3,3,4,2,6,5,1,6,6,7,7,5,9,7,1,1,2,1,1,2,3,3,3,4,3,4,5,2,7,2,3,5,5,7,10,6,6,3,3,1,3,3,2,2,4,2,1,8,4,1,5,2,2,1,5,4,4,2,4,3,4,3,5,3,3,2,4,7,3,4,5,6,1,2,4,1,1,2,3,1,3,4,1,1,1,1,4,3,1,1,2,3,4,4],[684,738,733,700,715,732,706,745,731,725,727,684,708,730,745,697,688,879,1112,1004,1112,693,756,714,700,802,809,802,807,706,804,692,784,715,788,725,738,690,701,702,783,725,705,730,705,708,768,922,971,1031,1031,1084,1084,1084,1084,827,813,810,791,793,823,790,871,871,871,871,868,871,817,816,871,870,871,871,871,871,871,870,871,1099,1100,795,806,809,794,800,795,812,783,810,795,774,789,788,938,1020,1020,782,784,935,786,1021,783,783,675,665,637,696,984,763,1033,929,996,996,1031,1068,1029,1029,1123,1123,819,821,937,827,826,994,987,828,936,827,1018,815,826,953,1017,1114,936,1139,1140,1128,1127,935,1000,652,651,997,788,735,1092,1092,1092,992,989,998,993,870,1000,829,951,951,992,951,957,937,963,904,870,870,908,917,951,869,870,921,918,938,870,922,881,923,881,1140,881,1140,1140,740,727,710,698,699,702,703,698,712,995,1124,995,1124,1038,995],[8.824749365014901,9.841309161633253,9.560780087398269,9.609730694698495,8.351051356926297,9.493987327331997,8.959800101710618,9.813440632861985,10.33107893362436,10.35508345018716,9.468578313714218,8.781634782845055,8.864260892489662,10.20833682290085,8.322419517875769,8.658656564308684,8.758937761127504,10.44554992377083,8.511594233931927,9.091378726039954,8.521785148843771,10.50366761651425,8.704646117715711,10.19276585888967,10.73192674267997,8.314471405940422,8.417045945543181,8.638482315205467,8.4059952747435,10.98228334477855,8.286893659111724,10.33824705296294,11.12456815421478,9.929383619565122,8.025324538459815,9.356118762946833,9.0389057223884,10.79053834758378,10.82314475291788,10.85403032454929,10.9939398959525,9.229041161352155,10.45529666083993,9.142409158760005,10.46297966358125,9.677812145232696,9.834988724278183,8.123127797020356,10.70856686918032,10.88948828928752,10.77605437597807,10.03447347633224,9.965979176276434,10.03447347633224,9.969738170006332,6.388554364321747,6.301507581444339,6.448979910702711,6.515231536409609,6.510499882548113,6.414329635683088,6.478998357041966,7.81773118291976,7.911384557234047,7.812577497919498,7.766821607243307,7.800319678596142,8.191826330340485,6.868769586573729,6.713893316322298,7.993578123554866,8.212370894609514,8.090259192802931,7.737516272856958,8.032983818870076,8.221590526277909,7.605542230079588,7.863142611549513,8.273328739599551,7.588973474656266,7.615061184806512,13.99333524878489,14.02094970977574,14.09239108347946,14.13787122789797,13.46147060752003,13.99333524878489,13.9827812523704,12.60741217712676,13.89770692027371,13.99333524878489,13.64161796734343,14.01695270468771,12.26379366628582,12.41722526144454,13.87610268211251,13.87610268211251,13.89965674449894,13.98107051487197,12.30702929610272,13.21556739578801,13.79889022292036,13.11633835720191,13.43556158106079,3.627809618473939,3.731162871549135,3.296661908407119,4.67448433703813,3.532188277336298,3.429660600977578,4.908833848904694,4.649044874979976,1.93103283677302,2.830216958386952,3.827932359720969,3.028260263299084,2.415648960063838,2.337800860057552,5.209937262252108,5.272590112359968,12.77566626936397,13.50951127116648,14.18419962293818,13.43839820422409,13.56259444883917,14.20003221619296,13.97318539071882,13.6141949873217,14.18419962293818,13.59669514036931,14.99305855504835,13.33586079531316,13.05322109103452,14.52588975958296,14.99305855504835,14.25421519520352,13.89118005779684,14.29190552304933,14.31875735946396,14.94206552171047,14.94206552171047,13.84321058848063,14.18906271571875,5.95250471017105,5.95250471017105,2.307654715971608,2.036124868802101,1.264168110744816,1.673865748100926,1.610956363645197,1.772099247779562,17.4095672702416,17.14687374873999,16.70931800869815,17.30713723360519,16.15586645353867,16.80344597927829,14.77517729975656,16.93424978206331,16.89648432227778,17.27160041689547,16.20991852407218,17.03571530238177,14.51650275974458,16.37372571285794,16.36420488620056,16.20355309758045,15.98732761176858,16.63902406824553,17.26445312367152,16.93424978206331,16.18961831646753,15.99252909692659,16.34350722380331,17.23512870145695,14.76384974646667,16.04014656818643,16.27913818008446,16.18479380832745,16.48196292874878,15.91394972776046,16.64920014733292,16.2195611082202,16.64920014733292,16.64920014733292,9.992748096573671,10.17485452590672,10.32526202344421,9.498100945324371,9.494099256447422,9.752740491635398,9.852029124732049,9.498100945324371,10.18673435176069,9.872298914766883,9.574671172295082,9.80262144158417,9.518165185847243,9.894157311482019,9.80262144158417],[0.2514064556570536,0.631844773257057,1.08241680044575,0.3473195214985103,0.1958226408780267,1.010588098199319,0.45906844003184,0.5710651114206786,0.4019690123452248,0.7278337147266558,0.6994089552748494,0.1915145019526449,0.3672520439804932,0.3424233232331323,0.3342701904561068,0.1443214812796945,0.1692353711962445,0.297935002286569,0.25495444763388,0.1693380363326611,0.1922616673747036,0.3467122362640085,0.2298374598401112,0.129622054362471,0.9329149102374354,1.468940754058323,1.295559052551421,1.345118168861209,1.335859370729769,0.9638608874405709,1.366869259799104,0.18124497702514,1.093116748038273,0.3146028854581392,1.463372898502567,0.2892772041958038,0.303801970272893,0.7955720992807023,0.8103128992623223,0.9144473700402856,1.015384521382644,0.1161913763050138,0.3240963244889319,0.7403951474794195,0.3166534258272131,0.1697576944380223,0.6113360598765245,1.717080783235571,0.6067750328736622,0.8071001064889823,0.7164719992165615,0.5955583566909751,0.6018249283728488,0.5955583566909751,0.5601339697235926,0.08223322824967723,0.05801579573682659,0.236685117516216,0.6857835141863576,0.4103783248350817,0.1011506178299231,0.6858165500463518,0.7773813982910774,0.411549869801677,0.2913491381966922,0.4189348737729679,0.6339291397937785,0.444818640633349,0.5496318254595488,0.4992836272666526,0.4607032257010478,0.4180457837175712,0.5755253819741721,0.862217772871223,0.4982994752416089,0.4230830091531977,0.2727174967647779,0.7314629594283473,0.3545710103742906,0.3268260874768278,0.3821991811817652,1.712719412987005,1.750138714789156,1.707116164563078,1.727212635649084,1.019956630961288,1.712719412987005,1.743902377208138,0.09512453758895191,1.567464046075684,1.712719412987005,0.3419082708250732,0.365659279334277,0.5121324347114463,0.4664771202932869,1.746031145908564,1.746031145908564,0.2235705963279839,0.3514096906505315,0.4304981911575955,0.3296011596839802,1.680889776211472,0.2581258440690923,0.4882402687549264,0.07486105528822827,0.501456868829436,0.04037354426778252,0.5966129498244086,0.4752692887210877,0.2995368896122912,0.638448534097167,0.3743264469964083,0.2343361923600364,0.07730672803007713,0.1178110015160532,0.1648575818965842,0.1044935132955605,0.1817378056282768,0.04667707105545876,0.03425913929633899,2.408186895686703,1.902022902785532,1.552946434742401,2.177098243697652,1.521458378499178,2.262609965074764,2.304268309701725,1.415755628636137,1.552946434742401,1.969291949444748,0.7660856258852913,1.827555116342942,2.266969122272446,1.16657256690851,0.7660856258852913,2.039392839534297,1.404119394318988,2.086635574414715,2.139204784302879,0.6192514274289204,0.6192514274289204,1.366076183655091,0.9102064887242675,1.409620498578299,1.409620498578299,0.7005043415985226,0.3468441437182651,0.1287425453933698,0.1778555602880986,0.2673639878744654,0.1405167383636483,1.149755909810493,1.248288031992958,0.9357799675816614,1.143547587589538,0.4420485253749882,1.071794139933693,0.3560681708734912,0.8909900389716142,0.908665650099389,1.072955892470856,0.2521665538040244,0.8338520657669891,0.389463724969334,0.3236173711104011,0.3614225964572766,0.4624121995130011,0.5250710866806955,0.446470346776095,0.6931257926824022,0.8909900389716142,0.5819749351944854,0.5266600705809394,0.5816680017852993,0.6060527795641181,0.2691171321434929,0.5543648744134893,0.6005694731702225,0.8187310102089186,0.5318048427039177,0.4710576754362914,0.07915902261799117,0.8542679447620812,0.07915902261799117,0.07915902261799117,1.069642338641255,0.8897570700814409,0.4929646531801002,0.2157465695662887,0.1576284259828084,0.4459228200091456,0.4760916243702984,0.2157465695662887,0.4117993770805971,0.3695098202982329,0.08366789641538364,0.3007994979955407,0.05902060145685661,0.3386200449545527,0.3007994979955407],[0.4418265299182727,0.2697256038827226,0.2582951254928067,0.4364751790345716,0.07009081694670824,0.2989352668695212,0.2292117816426228,0.3427167323956571,0.2165678592767687,0.5557881173911734,0.4319675717777593,0.4051590405740665,0.2231351549384646,0.2475826279003422,0.288643881599123,0.2389065695352567,0.3300915117455133,0.1177954789806334,0.3828329200941289,0.2510382579390721,0.4496306534014213,0.2553762759800471,0.8022533975385208,0.1763095813446206,0.3036916052472513,0.3022822361796224,0.1387759567875103,0.2874999820653041,0.170324036352997,0.2640584855388498,0.2694063346295139,0.3443882161420796,0.7855651313782074,0.3580130609320681,0.5238229589040397,0.3903438935253336,0.4462401608082981,0.2118656419129431,0.3411766258790581,0.4404555679449415,0.7896638397779597,0.2409353620064074,0.3833778995158524,0.6208938053855528,0.3457335319221063,0.4274415536172921,0.5458350291602598,0.5818026434095634,0.567482183447044,0.261227920132197,0.2291403887528431,0.1833273641333248,0.193750994172888,0.1833273641333248,0.2462197009479354,0.5973313836964416,0.5115767239940615,0.7129874601235885,0.9306711445795537,0.8385008743398836,0.6393669176843119,0.8959901247939299,0.6203701205083885,0.8533024939513598,0.8634339959549565,0.8626567188080838,0.7088216691708803,0.5537605517411579,1.103915996033055,1.004199279798205,0.8342524184920667,0.6690584925217011,0.4759312290154368,0.6935586955837861,0.8092782065570361,0.5152170603735688,0.8047637604002653,0.5738702220217374,0.6109752728442387,0.8458669892784449,0.9068197583132258,1.371369703903224,1.150492816789172,1.227036970465575,0.9427084712321799,1.039830605553886,1.371369703903224,1.333323200196444,1.712720492331435,1.042375065543239,1.371369703903224,0.797618449734906,0.4303716154489765,2.092798078660038,1.892701864210946,1.535165235004502,1.535165235004502,0.654612421372334,0.4007892128982668,2.033459425256863,1.158100097275147,1.398279578488935,1.233491936798575,0.9440809847033399,0.1428398288202856,0.3119699103284659,0.3083435066707623,0.4681185041558839,0.3435082870358652,0.4203963741692873,0.6055551340747128,0.2804966526708204,0.3659433522955143,0.1888018218760343,0.1265582005534774,0.2484951003899703,0.1696490000169523,0.2067577721999265,0.04638067252333601,0.1216146336781402,0.5044094148322623,0.238928347106582,0.765756586180773,0.3635665500995958,0.5906047035595873,1.249743029942499,1.047425314148144,0.725122543747208,0.765756586180773,0.3745088370641084,0.2303539119023809,0.304539750383927,0.2271452179923547,0.3673434324315423,0.2303539119023809,1.095885669642003,0.6874464993398651,1.131608662698178,1.176257264321863,0.3730560472341143,0.3730560472341143,0.6971109006101651,0.8665055109819602,0.2485554030603643,0.2485554030603643,0.3357943735658508,0.2400732706561906,0.1166534937938511,0.1901321875078347,0.2359773444597107,0.2305216992037597,2.521706908997549,2.2854728601747,1.824950770830065,2.423120030016009,2.490051663796965,1.932364677579537,1.450843831667484,2.045110894003759,2.008560206735853,2.384092424601902,2.706354128083404,2.145104598136654,1.061772633897099,2.647044834070609,1.677613336914657,2.510249208783415,2.311497543726118,2.090115673899623,2.398586190575273,2.045110894003759,2.398886906653779,2.256855957707311,1.484011784682253,2.386907640474948,0.8816389188050291,2.32479595690432,1.428045137665682,2.059973108136013,1.615144773115578,2.34701070601947,1.919938762272507,2.075794524400488,1.919938762272507,1.919938762272507,0.2450638586608126,0.3043431141870163,0.8496891094731607,0.3477723083432777,0.4105973919671649,0.2823968868584067,0.382901494165968,0.3477723083432777,0.5844182889875941,0.24035272792324,0.6288389045496232,0.312575434745457,0.5145461029688998,0.285482974738018,0.312575434745457],[0.688514408067865,1.096909604673601,0.8862858628139101,1.409316868376353,0.8867502352432817,0.9213692187721575,0.5005311232968501,1.202184327304667,0.6969717925765488,1.037261425361837,0.4073292121516036,0.7427887430710036,0.5115747040975368,0.6952525336470327,0.6838526951757972,0.3709393689036893,0.3383914849058478,0.3983046572261371,0.7707145480810634,0.3874877367298873,0.8186002367378454,0.9080073579912777,0.9565096455774331,0.2641501275154189,0.8440988228591788,0.3676605231087277,0.5392712409681368,0.5333093072312871,0.4952944231349398,0.7964802302059998,0.4677946920566157,0.9762826878534381,0.8253915627402253,0.5243439757783747,0.479018511600135,0.6821465613987234,0.8022454905670212,0.6843714035586592,0.6118913000607339,0.654078460154776,0.9371100188665084,0.7603003189980501,0.9996475969190112,0.151945998500475,0.9756879455543377,0.4863570021716757,0.7222417273674944,0.1422119148085323,0.3616440937326362,0.5071400199337103,0.6231159039602973,0.4636197352490438,0.394995977064566,0.4636197352490438,0.4051688017854494,0.8737287836856179,0.9112160393342194,0.6450882026911338,0.4523973860710921,0.5222561930775703,0.7532405172871356,0.4895238527017824,0.8163288998301137,1.08449825286227,1.033927220871924,0.9033103147060398,0.8562406937247676,1.08457427678223,0.4004867719675683,0.3557527326227131,1.170880279196496,1.166259171824026,1.063816727251938,0.7258732422456919,1.203087541697359,1.042845021918753,0.8232543793407564,0.8598419559823098,1.093606321165897,0.7781363165300945,0.7700955783670859,0.5400726980755272,0.4496632757420396,0.5505602784290072,0.5416303784214389,0.3676681432762353,0.5400726980755272,0.5052712021546606,0.6374794333559847,0.3003733886846475,0.5400726980755272,0.4894211029625282,0.9557982324873209,1.1638278812158,0.8476256699947167,0.5772376668860352,0.5772376668860352,0.8676008134305492,0.9451344403586061,0.9343299169861985,0.396431547462038,0.3954340596436755,0.166998983475289,0.2730760299204468,0.7596885768302075,1.102211514593091,0.6192523862580371,0.4440252025543875,1.103689622924896,0.8132700416417682,1.165436489438494,0.7638127581734444,0.5691684057570507,0.5577333274672348,0.1454626112482514,0.4958440171597852,0.3475468896356154,0.4252611542460625,0.4128936279264445,0.4316716602699107,0.4810135252737128,0.1752872373273144,0.3721341750990271,0.1364082383329461,0.1687116980181175,0.3884538971772823,0.4290261702659398,0.2093789680431222,0.3721341750990271,0.1359018827687473,0.5459017226514482,0.1278951213460524,0.3294750453507614,0.2099468928281872,0.5459017226514482,0.1662410780789255,0.2411749318613968,0.2156350820509472,0.2775250063556067,0.5074275671992885,0.5074275671992885,0.138725715776613,0.09329559297102408,0.04716289061557351,0.04716289061557351,0.3497972544017379,0.08338689737099543,0.3277449466657256,0.3796707180670566,0.29771914919713,0.4548196388151249,0.792723043597149,0.8301160451518425,0.5220771557017047,0.7596043308613921,0.6186292618343183,0.6483143139600448,0.103452739366537,0.4659221846447451,0.4817575668142978,0.6912468010214704,0.8021674972902035,0.4272282710173121,0.0901878473788138,1.155156927992305,0.6533675213515918,0.6544789815952398,0.4213230300538451,0.6513526490063635,0.4787802315293804,0.4659221846447451,0.5653874737128822,0.3909692504801448,0.4432520385988791,0.4637348603800583,0.2987120766762161,0.4565037295319226,0.5065558052713509,0.1688578550813044,0.309591296081597,0.4246139075352648,0.4825561697889372,0.1826181141874051,0.4825561697889372,0.4825561697889372,1.462645696261859,1.125595893555152,0.6621202800355099,0.6244610040824405,0.6551980882931411,0.3496961370886073,0.2447070292075746,0.6244610040824405,0.3889990468858106,0.3225153650528859,0.7315139912464321,0.3836825523247134,0.6898200662158579,0.4316747747584736,0.3836825523247134],[0.745085897265065,0.4294870168408109,0.7800777351275503,0.1776163370978329,0.913387539450056,0.8234049397912351,0.4933893787891008,0.4129614978458282,0.1498512605717738,0.1366177738638644,0.3316902046424213,0.7338473829243578,0.5300367124772086,0.2340510049020452,0.4247537551673894,0.5115783703508593,0.4693407522607833,0.4504933358273865,0.4424275307186077,0.4731374835924576,0.4892227705409442,0.3814181592661775,0.3808885587842172,0.6345888252198715,0.6800165680077831,0.6796072246351789,0.5317642752910462,0.7809129601253657,0.5759874843404441,0.5592846389139541,0.5705922142160244,0.3333685818831013,0.2260579486306525,0.4773511362024369,0.6629528337447306,0.8148452077272235,0.6267571002636549,0.707140910401186,0.6831379245119082,0.6199056178809491,0.3233336763182365,0.5139207533724707,0.2471742557694709,0.1899422758956065,0.2909016354862133,0.9667294309672988,0.2967551942285246,0.9210875420456375,0.9949075282612229,0.5421779895484572,0.6386433994553186,0.9475691764506515,0.8858718305992087,0.9475691764506515,0.8683427224480782,0.8801624915069473,0.9504607348053337,0.8038626151642534,0.4371412092105423,0.6342840024436514,0.9411289832414336,0.4654091395687875,0.3256737687832738,0.5946800115404632,0.4922230883134467,0.4965310877683343,0.3981211360583586,0.3741022853060529,0.7312106336607865,0.5810707959386396,0.5988277978814315,0.5059893200430332,0.2145841913170352,0.4360386543307666,0.5843362857724487,0.35133017391641,0.3098031770552512,0.2812077125217939,0.4774656587789084,0.3103237301149008,0.3577921960622462,0.8908558798051055,0.8920647166287187,0.9677575797873491,1.024933363610804,0.5826930333663882,0.8908558798051055,0.87174573525699,1.047797716224739,0.7822200375461543,0.8908558798051055,1.535927838953589,1.528989769544452,0.6391801977603665,0.7900497773698686,0.7658371763072009,0.7658371763072009,1.754189344515472,1.500647447177083,0.6870822125179018,1.562719913269506,0.6963563520753629,1.283853100802547,1.38867038118869,0.6605268582714143,0.2717619787266234,0.5581292586570975,0.5688724619377182,0.4750268105664817,0.9315880614660886,0.3947368533363325,1.083944380598511,0.7177337482986519,0.4235906245869824,0.743337340103229,0.5653231924867723,0.2968367050513072,0.3132001553242414,0.5200768320107579,0.4563752162672514,0.3346731163614957,0.6818209034843227,1.305816952809042,0.8471043330728492,0.5165815028550372,1.737539015278018,1.537015468934137,0.5478604568516018,1.305816952809042,0.8519635867060449,0.9371601606329658,0.3854774389307334,0.4456018756749323,1.237823949807746,0.9371601606329658,1.6422243775953,0.90249149706597,1.711369533728483,1.772272567090759,0.9284406900922606,0.9284406900922606,0.8206384069764548,0.680789873338575,0.1986452487604691,0.1986452487604691,0.3129217451944659,0.2627301406745907,0.115249475823685,0.4646672697135512,0.3673985427951721,0.5683645661723388,1.727832226764864,1.65439771972543,1.178858214803564,1.687553690552071,1.328157689649806,1.33562532417422,0.5038119530376168,1.31237300502387,1.296150990668388,1.621311886435337,1.557783820493899,1.348208017268956,0.2786863906128025,1.913150128628813,0.3273577484891398,1.326329167230333,1.215536195647886,0.6521652386941965,1.348306422732655,1.31237300502387,1.198324633173244,1.147446578607804,0.5966592840051443,1.278043016669932,0.5495165636895066,1.198032745344582,0.5244338627417622,0.7720376198960376,0.7307269108173469,1.303377136273773,0.6144847516244398,0.7699246358440942,0.6144847516244398,0.6144847516244398,0.6037858639089106,0.3268844915614736,0.6662832592101596,0.6243112821843961,0.5850172564471402,0.8204976679310984,0.7711998284574713,0.6243112821843961,0.8407011262288537,0.4311676919309493,0.402026431996325,0.4298210441340216,0.5063095661145809,0.2892592640324836,0.4298210441340216],[1.270393136677114,0.4045792120550554,2.094237512319529,0.1375070221420692,1.502892754319332,2.002645663760556,1.896731645260904,0.300680938385506,0.9249007790696394,0.7620651783825203,1.769598530607952,1.265003309606907,1.814631386666796,0.8520768312973621,1.13999568622767,1.341398441532805,1.406157216123076,1.217107360855485,1.093464056472886,1.371690250183088,1.099544551424177,0.8256867033616689,2.514499408675746,1.757619277575299,1.470409487180702,3.102910450720391,3.054479407741607,3.047990732246212,3.082044362056677,1.677130836412663,2.993598055665161,0.9063937238686787,0.251488293451454,1.898900197267599,2.837334820320517,2.511304243933197,2.813743864285131,1.759491353236998,1.180840745278631,1.313953689033883,0.1146611766566171,2.605718282879015,0.7384980162800241,2.528947468445489,0.7693643863418206,2.186649552272445,1.88657748145099,3.161236881900627,1.50489739780875,1.051228555183232,1.082002823544041,1.566714689971431,1.607689631345495,1.566714689971431,1.55873028154778,1.478628847661824,1.50990256016426,1.231419484800093,0.9472883625042482,1.082440245374743,1.351566417521084,0.9789417515628047,0.5207916777879303,0.5270736232592135,0.4710815599919215,0.3539537796375515,0.3987015087324664,0.7691633477410075,0.9959022167702288,0.9538648589441858,0.6141634973872994,0.8030411548800888,0.6797472511806188,0.5691934898233779,0.6486793827312397,0.7985750233920863,0.2649106486614675,0.5628138498405107,0.8569393815318965,0.2161291617987824,0.2096931366032602,3.973314404001991,3.972500450978258,4.053970433776091,4.071903511433379,3.381313025438637,3.973314404001991,3.956941664387363,2.557624164310665,3.835255693426723,3.973314404001991,3.6430436537697,3.821962673174357,2.183469673202882,2.446390449514762,3.880756024501783,3.880756024501783,3.806045009250171,3.773424575316541,2.316520145277786,3.254969450872571,3.777344130158983,3.101337390128838,3.425273226585934,5.659450303139664,5.225708367760446,4.5231963275629,5.207605851608736,5.010213188428992,5.814027929231906,4.3536832383315,3.570989701582341,6.269862946842823,4.896965287955739,3.74688013083115,4.704322456860201,4.539146020538631,4.580435994701489,5.23638771144882,5.216974372299672,3.944547443186984,4.597741998132333,5.187710796675808,4.717962676687896,4.34828879296539,5.632754287673227,5.416147098224609,4.329588477121855,5.187710796675808,4.763554816504241,5.677497386650897,4.271843132188334,4.255611137065506,5.364684503235116,5.677497386650897,5.555749407846992,4.745457294828328,5.623220317754307,5.68167095374807,5.564712109489696,5.564712109489696,4.651798612094267,4.818308966726287,0.3428087201161694,0.3428087201161694,5.107999742397094,5.500087874469514,5.800262176223741,6.139133271723378,6.056837695333813,6.201406801007105,8.056393419228822,7.895150732839646,7.407484460521228,7.98017952166049,6.227769230939845,7.54073037820429,5.030705323184281,7.592966106752174,7.566559275406943,7.926963335173102,6.244686734843367,7.65748229916032,4.930938635472813,6.362961176414161,6.760313662508147,6.276233668308776,6.080666292470705,6.929851461480182,7.767491054675598,7.592966106752174,6.285378290279772,6.098814216586899,6.901944050150832,7.707241652171128,5.207842559364784,6.135946655685494,6.830170091972325,6.369417934393258,7.042171960202761,5.99275530970335,7.044988271911847,6.405590117346073,7.044988271911847,7.044988271911847,1.923786633615191,1.537129362717624,0.473557942646733,1.28519338106919,1.317951082240449,0.9295716794681793,0.8400489536407248,1.28519338106919,0.4880084664976592,0.9696101355986675,1.378809707469627,1.037575170907756,1.350339621908441,1.043778807121856,1.037575170907756],[0.5534331468684358,1.067701240677862,0.9751112742190106,1.175239177027524,1.005549743553443,1.042749721404275,0.6622916674268802,1.142620156982946,1.232796770481925,1.45665954041109,0.3244949803728591,0.6083720659064451,0.6697436530449388,1.118632799133741,0.7262872251816554,0.354188956689383,0.2643950317185864,1.207369711512661,0.664790103350106,0.2178498140287192,0.7045183234665028,0.8739955222856454,1.038436842671647,0.9717941409522441,0.8828996557396293,2.178473751342634,2.004831576105687,2.095724255789014,2.048222265554408,1.276926658410391,2.096187684093083,0.7703742591683513,1.689920857730067,0.9898047094752491,2.127580690231978,0.4989897531901812,0.8782382242452265,1.104730854559904,0.9782963312503739,0.9973835593733352,1.637996385488396,0.8448906098698783,0.9384072017268321,1.507144973669564,0.9099836277024259,0.2452392527924899,1.237471525389266,2.25269448786787,1.253029382060669,1.06875672878929,0.9528409960453609,0.1778678680214283,0.1092342139464788,0.1778678680214283,0.1295601756869726,0.8443276055391774,0.8721895266097378,0.5942706381242125,0.421330439297836,0.4543835040622986,0.7139549831973481,0.4589525232390984,0.8988458061530149,1.156586615832764,1.10895860367654,0.9742112383786662,0.9218666895522024,0.997182626507123,0.4225517317635306,0.3180590604068804,1.242608151223568,1.065601154496074,1.002832149795077,0.8171083454170182,1.251057126104,0.9558790792742867,0.8997662295568859,0.9433640561943489,0.9912001037123221,0.8537732608640727,0.8437786008205245,1.474968206985713,1.335892862800002,1.451428797719292,1.260409501689996,0.6445491771516028,1.474968206985713,1.467546353878825,0.7119441386793152,1.141502043089257,1.474968206985713,0.4716008245055989,1.087228019948495,1.201310962239796,0.9527308492299597,1.300367149436351,1.300367149436351,0.8586264626639576,1.092876078116418,1.033012097095185,0.4831782624229072,1.331104410364261,0.2813104316507979,0.2821545880840206,1.642316878808228,1.411712598576626,0.6372419894700677,1.669952207469283,1.128337501166933,1.66482669345058,0.727835480743433,0.528365937160055,0.3342137139490891,0.5870791712953431,1.091972899630211,0.5226081643567076,0.3461455171669698,0.4240440547245757,1.556974554797636,1.528606584155356,1.215616342507502,0.5158035293597357,0.1959861849390272,0.4748790327524985,0.512612818547815,0.5795409893714207,0.450107297321739,0.4648398481963229,0.1959861849390272,0.3523940281894378,0.6917037942008177,0.7612238860000539,0.9027625884066532,0.2786087113555818,0.6917037942008177,0.446534774059182,0.2676450907470454,0.5179514443152813,0.5825628958724918,0.5646590838385966,0.5646590838385966,0.2479567211209449,0.1189154115420483,1.476212820613634,1.476212820613634,0.3341244471688692,0.407217793612871,0.2802340407282093,0.332985789848242,0.4154531751877462,0.2934693011270633,0.7055195439348558,0.7527757340643964,0.4842704350797064,0.6734041943269333,0.3406077175439962,0.5962087396601283,0.3307655796804808,0.3954265313594997,0.4166421134160992,0.6047387215574717,0.2150420931903932,0.3439262841456413,0.3883011891756303,0.4339465441398522,0.388175183991252,0.3709495421056291,0.4109318234077909,0.08418592218008662,0.4155350279488291,0.3954265313594997,0.4785536434692366,0.4787196068077746,0.4783820697986069,0.4182450921141254,0.4176109266952366,0.4297559946839097,0.5338449516676874,0.2374741315417938,0.3585000211177238,0.3386886199836591,0.3127801756886533,0.2583285658175851,0.3127801756886533,0.3127801756886533,0.3931152288638689,0.493589384976364,0.6705906304130064,0.5273179940892249,0.5252595335050863,0.3793425767717298,0.2785168941423316,0.5273179940892249,0.4104759775968682,0.1633629337920786,0.4936792767535166,0.2225758048260226,0.5087270783629179,0.1430182160083842,0.2225758048260226],[0.1364596173706433,0.2569863455923255,0.1906188736210914,0.2994545595575803,0.1026455382488256,0.2265182765076858,0.1251908556085484,0.2902758529261302,4.946653971162506e-08,0.2110335572280424,0.1430775373177924,0.1962551936831715,0.1170661036596078,0.1245385067460375,0.09399557215931095,0.1278504224721798,0.08068356901445684,0.1628634464314733,0.2884029642322997,0.1146445122783424,0.3123898157727098,0.2171539366599794,0.1290443496268926,0.3039628880858078,0.1570803353489876,0.2712250055775506,0.1718113580747028,0.3496892909099837,0.217015646263223,0.2007617873919313,0.2293306610122468,0.3598701935638254,0.2035021094202708,0.1599571424562032,0.04632071602947702,0.1516497873490713,0.1438746880317004,0.1389855382500183,0.2519413628636316,0.3146928728304457,0.06998363858047654,0.1947688001394655,0.3438577683739169,0.1763514708476057,0.309576922004077,0.1230037425458104,0.3527308207441242,0.1699041547908315,0.06720936596568457,0.1810342220350832,0.1403946753502643,0.1187849700158131,0.0530781619748036,0.1187849700158131,0.06472437450529492,4.86216803905536e-08,0.09407359505782424,0.1530630111809526,0.1877689893801003,0.06316270593387352,0.1501488505225603,0.2179558106747419,0.1604141666491467,0.2398709604002663,0.3156393069014956,0.1695923022472855,0.1308900414008533,0.311461966699573,0.2993504731577021,0.1564293197049301,0.2893547219532052,0.3761356542685803,0.2270791287550704,0.1147927539528064,0.3003715077355873,0.3369484095558131,0.3636172354879381,0.2018520810033951,0.4134317498996383,0.3453721299089758,0.2964845345935324,0.1137885590269182,0.2016554831024193,0.2736701459039741,0.2498132616817793,0.3483990331595752,0.1137885590269182,0.1464628319574713,0.2340387952926551,0.1629363265659044,0.1137885590269182,0.1075059632755224,0.1840750042361582,0.07375263754271671,0.1327033386424941,0.07345367153142193,0.07345367153142193,0.1051364877716899,0.1704672033528934,0.1187462884336914,0.169766879325392,0.1542130172740528,0.1553716215290324,0.2730283428728772,0.3062710242556437,0.2612372607359826,0.2485270775695985,0.1935643742423514,0.2151635609784444,0.2759067931923684,0.2486772680875786,0.2513764625021007,0.2126711783370962,0.1473523274238014,0.1563504926918435,0.07361428053292657,0.1496126341117568,0.2273106603505462,0.1240255159758198,0.1954842098467225,0.4067924613352759,0.2141532581004406,0.1518671963443763,0.2434189063006722,0.125764256961875,0.1788787950573138,0.3334793727480046,0.250892151802724,0.1518671963443763,0.2353926324829047,0.09408678095965796,0.2670203300208933,0.1170369596156554,0.2786087130008464,0.09408678095965796,0.075568042987764,0.2417610139194134,3.541557576280816e-08,0.07071743650338354,0.1476845565224225,0.1476845565224225,0.2430204985017693,0.1189154423841714,0.2594023288134265,0.2594023288134265,0.1518294164990019,0.05966438137733264,0.4579996877154223,0.0280349864391529,0.08602479981003257,0.1161108925295621,0.7338900983881491,0.7924907480255198,0.5236579693906898,0.7065276809350676,0.3406076692392376,0.6376789793656804,0.1895886315775067,0.4369133108524322,0.4585043990359361,0.6372530514890608,0.2150420575400882,0.3811599861986713,0.09189297575186763,0.433946552930052,0.3807729789506473,0.3709494941215233,0.3784559443606979,0.07126300627908841,0.4135468240189756,0.4369133108524322,0.4174450665891116,0.335274770224781,0.4812919966651515,0.3321898940674722,0.2864996041236844,0.4039243177437765,0.5366977157201566,7.183371801158557e-09,0.3614498484113972,0.3386885836928343,0.2861717072955384,0.03623483015562902,0.2861717072955384,0.2861717072955384,0.1339939975267077,0.1189787063697088,0.2145158414477296,0.2157470992398663,0.1576289369216075,0.1800335220243168,0.07498016445416747,0.2157470992398663,0.2512252232994443,0.1087268734346643,0.08366735809317487,0.1787456375139196,0.05902101566677886,0.1603546691264897,0.1787456375139196],[0.2708221660002681,0.3101888523374628,0.3187560006908588,0.4586747518584054,0.3379802605886055,0.3126718757811149,0.3090574249352431,0.3799989001721756,0.6927238233912739,0.7791884979870463,0.4168814020593827,0.2220075645014542,0.3352917185346077,0.5712320040896081,0.3492533003810606,0.2129570933933857,0.2472644543945397,0.8655868729312074,0.3144801171845626,0.1944842214367405,0.3606428128059895,0.2915494319346975,0.3748692419595946,0.2025361533491906,0.3416858176093396,0.3430470117855852,0.1718116119157146,0.3497368687109658,0.2170158956721576,0.2487605486759639,0.2667102641040552,0.4273490919431182,0.335866258300006,0.3796437163739284,0.4872513108703042,0.410433716033397,0.4027942402936854,0.1389862295175528,0.3428251388052729,0.4803296463830368,0.2415848244967806,0.1947697892734334,0.4101085150757099,0.3790730811512668,0.3755295012802559,0.3869658109006486,0.3246948521998812,0.4961469475250009,0.4899099185157407,0.2443314160668437,0.2351722324753008,0.2505670814372428,0.19514159394953,0.2505670814372428,0.2411227988621694,0.5555036819988028,0.4692106771591743,0.392925823973961,0.3029042138744713,0.2506978379291309,0.5190478696202728,0.3369007920552772,0.08449714302347595,0.2280367412058568,0.2044230514349736,0.05614045726194484,0.2409890385350223,0.4859385432939788,0.2993507690019986,0.1451307459125787,0.3144477977881358,0.5043911744499771,0.4352521148412204,0.08159985257175255,0.3476195474329795,0.4923639426692817,0.1484149853130929,0.1155433504773381,0.5021904977845006,0.1318891291027717,0.09615471898543364,0.1137885590265037,0.3285386995846996,0.2764641365644052,0.389753199999203,0.3561461933436191,0.1137885590265037,0.1464628319568533,0.2340389897540888,0.1629369518365253,0.1137885590265037,0.2306137378046746,0.308566989286164,0.3784863984903532,0.4533122539273373,0.0734536715314239,0.0734536715314239,0.117359182567559,0.3100386706392227,0.3618587911466979,0.352809133095148,0.1821267152695313,0.1414664600518921,0.2429018869221435,0.3062723604822202,0.3019234361892054,0.33237795025721,0.3634323748187723,0.2627908249465941,0.2759076465086631,0.2132122035089554,0.311533400888457,0.3282383733565093,0.2476168363993484,0.2155710584928949,0.07361453915439865,0.2110819665406891,0.2565554913625516,0.1902061628270728,0.2642182749932223,0.1076280742164612,0.1936287678068848,0.1924933451351427,0.1968796597616478,0.5548389385608397,0.3776429810351383,0.4501070303267845,0.4687419638343975,0.1924933451351427,0.2415088670367241,0.1897461950691093,0.4427723806449829,0.3157827140524543,0.2703070480145729,0.1897461950691093,0.1674743395899389,0.3154354635664281,0.1993839360850021,0.2530799535987502,0.1881734151913521,0.1881734151913521,0.3169615517342524,0.1217044354338615,0.7349323544499414,0.7349323544499414,0.4176036062711138,0.2849343332702647,0.06720911341128827,0.1851429151520753,0.2480463971325536,0.2038607217121142,0.8160797373851825,0.8749933678404398,0.5553667084189362,0.7969269092687942,0.1975278656119498,0.6861703203342466,0.1895888405727461,0.5096182980210638,0.5240810428003975,0.7268983086309758,0.1951601627928553,0.4729155280113668,0.3540262208757936,0.4237084687461414,0.4227892520986932,0.235998227482853,1.05903591896675e-06,0.1133102546060702,0.4399423334632256,0.5096182980210638,0.2048117245880163,0.06823600763633578,0.4210506408936899,0.4035338189196369,0.3795046237152135,0.05582803789196707,0.481143377016835,0.2309654620236496,0.2935616306246399,0.1124746660824313,0.3053013966709976,0.2505696850919502,0.3053013966709976,0.3053013966709976,0.09661607121565527,0.3718525610259652,0.3600240992071914,0.2223578282352351,0.1639809780937594,0.2874826971209352,0.3319321455752627,0.2223578282352351,0.4157731297637289,0.1087268738241578,0.07691503317080066,0.1787457586337303,0.06421476429730909,0.1603554685624307,0.1787457586337303],[1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,2,2,1,1,2,0,0,1,1,2,1,2,0,2,0,1,1,1,2,2,1,0,0,1,1,1,0,1,0,0,2,1,2,1,0,1,0,0,0,0,2,2,3,0,1,2,0,4,2,0,4,4,0,1,1,0,0,2,2,0,0,3,4,0,4,4,1,2,2,1,1,1,1,0,0,1,1,1,0,0,1,1,2,2,1,0,1,0,0,0,1,1,0,1,0,0,0,1,1,1,0,0,0,2,2,1,2,2,1,1,1,1,1,2,1,1,2,2,2,1,1,1,1,1,0,0,1,1,1,1,2,1,0,1,1,1,1,1,1,0,3,1,0,1,1,1,3,1,1,0,1,3,3,1,2,1,1,2,0,2,1,2,0,0,0,3,1,0,1,1,1,1,1,1,0,1,1,1,1,1,0,1,0,0,1],[6,5,2,3,3,2,3,4,3,2,4,4,4,5,2,7,8,2,4,7,2,2,2,1,3,1,3,3,3,1,2,4,3,3,2,4,2,2,3,4,2,2,2,2,2,6,1,1,0,3,4,8,8,8,6,4,4,5,3,5,4,3,3,2,2,3,4,2,4,6,2,2,3,3,2,3,2,3,4,2,2,2,4,4,3,3,2,3,4,4,2,4,3,3,3,2,2,3,4,3,5,3,4,4,1,3,1,2,2,1,2,2,6,5,0,1,2,2,3,3,2,5,4,2,2,3,2,3,4,6,3,2,3,4,3,5,3,5,4,3,3,3,8,2,2,0,1,1,7,6,7,3,2,1,2,8,1,4,3,2,3,4,5,5,2,4,5,7,3,6,3,4,7,3,6,2,6,3,5,3,9,6,3,6,6,3,3,5,2,1,2,2,2,5,4,2,4,1,3,4],[8,8,8,7,6,9,6,6,5,4,10,5,6,9,8,4,6,8,4,9,5,6,5,7,6,11,6,6,10,6,7,4,8,4,6,13,7,6,8,5,10,7,5,5,5,9,3,8,4,7,7,6,6,6,7,6,7,10,8,8,7,9,2,7,9,8,4,7,5,8,9,8,5,4,8,6,4,2,8,4,4,6,6,10,6,6,6,5,8,5,6,11,5,8,9,4,4,8,5,10,8,3,9,8,8,9,9,9,7,9,5,12,11,5,11,8,4,5,7,7,6,11,9,8,6,2,4,7,9,10,11,9,6,11,11,4,15,4,3,12,12,11,17,5,5,2,4,10,9,11,10,3,4,8,4,10,8,9,10,10,8,8,13,7,6,6,7,16,9,6,10,10,15,8,5,8,12,8,9,7,15,11,9,11,11,9,8,7,7,7,6,8,7,10,10,7,9,7,10,9],[2,2,1,2,2,1,3,2,2,2,2,2,3,2,2,3,3,2,2,3,2,2,2,3,5,1,2,2,1,4,1,2,1,4,3,4,2,4,2,4,1,2,2,1,2,3,3,1,4,2,2,4,4,4,2,5,4,3,2,3,3,2,2,0,0,0,1,2,2,2,0,1,2,2,0,2,0,2,2,0,0,2,2,2,2,3,2,2,3,3,2,3,3,3,2,2,2,3,3,2,4,3,3,3,2,2,4,1,3,2,2,2,1,3,2,3,2,2,1,1,2,4,5,4,2,3,4,2,5,4,4,3,3,4,4,4,5,3,3,3,3,4,3,1,1,2,2,1,1,1,1,2,2,3,2,3,3,2,4,3,2,2,4,2,2,3,3,3,2,4,4,3,3,4,4,2,3,3,3,4,3,3,3,3,3,0,0,3,2,2,3,3,2,3,3,2,2,2,2,2],[{"type":"Point","coordinates":[29179.9151421002,38822.07565078059]},{"type":"Point","coordinates":[28423.42303614652,39745.93657033527]},{"type":"Point","coordinates":[30550.38025215629,39588.76588790232]},{"type":"Point","coordinates":[28240.06325322351,39477.60302500725]},{"type":"Point","coordinates":[30443.26984850011,38382.84840348789]},{"type":"Point","coordinates":[30637.92415984448,39516.90348962062]},{"type":"Point","coordinates":[30347.47537277647,38995.85249926442]},{"type":"Point","coordinates":[28325.74934240541,39700.69913151954]},{"type":"Point","coordinates":[28611.8740149989,40270.60824717191]},{"type":"Point","coordinates":[28271.22275013477,40241.1067093374]},{"type":"Point","coordinates":[29873.58955885535,39507.66527723771]},{"type":"Point","coordinates":[29142.2442754134,38774.89152659191]},{"type":"Point","coordinates":[30340.88285454204,38900.47696265684]},{"type":"Point","coordinates":[28649.76874365104,40151.97503401823]},{"type":"Point","coordinates":[29933.30060270481,38362.35482948434]},{"type":"Point","coordinates":[29720.48913321616,38693.016630636]},{"type":"Point","coordinates":[29623.0155108789,38789.10228440962]},{"type":"Point","coordinates":[28895.92045772621,40421.86347594127]},{"type":"Point","coordinates":[29283.45010986174,38517.37448738867]},{"type":"Point","coordinates":[29419.80065704036,39109.98407627064]},{"type":"Point","coordinates":[29216.53958396887,38521.2580210356]},{"type":"Point","coordinates":[39846.56938329138,33842.54805581968]},{"type":"Point","coordinates":[37653.91242137503,34286.77499893264]},{"type":"Point","coordinates":[38830.61633747294,35225.59496140121]},{"type":"Point","coordinates":[39766.43120377888,34608.45516940062]},{"type":"Point","coordinates":[36683.42400583145,35060.29115067176]},{"type":"Point","coordinates":[36849.73964491775,35008.60127388936]},{"type":"Point","coordinates":[36897.6809832618,35313.55901898214]},{"type":"Point","coordinates":[36814.68789717715,35037.62382088153]},{"type":"Point","coordinates":[39764.88024201659,35172.0688773887]},{"type":"Point","coordinates":[36730.60313576225,34950.97203173727]},{"type":"Point","coordinates":[39699.12089832588,33765.22649372879]},{"type":"Point","coordinates":[40610.1061203116,33554.61441709926]},{"type":"Point","coordinates":[38519.04073992109,35232.49630383276]},{"type":"Point","coordinates":[36525.04523729086,34788.97666296712]},{"type":"Point","coordinates":[38276.08290362027,34507.53614237857]},{"type":"Point","coordinates":[37883.79073545929,34558.85233063509]},{"type":"Point","coordinates":[39599.04141434456,35075.49148994954]},{"type":"Point","coordinates":[39967.02309465809,34387.45221503179]},{"type":"Point","coordinates":[39940.62354086556,34522.49064509419]},{"type":"Point","coordinates":[40508.69333167074,33444.93507889152]},{"type":"Point","coordinates":[38005.49947845191,34727.56041175977]},{"type":"Point","coordinates":[39851.45009566864,33693.72655455459]},{"type":"Point","coordinates":[37570.16200005947,35247.23227170589]},{"type":"Point","coordinates":[39842.5830898882,33739.21058663521]},{"type":"Point","coordinates":[38645.43672228665,34497.86803382422]},{"type":"Point","coordinates":[38286.07699827552,35423.86608490387]},{"type":"Point","coordinates":[36406.81737305022,35104.44097002999]},{"type":"Point","coordinates":[39360.69560154264,35339.71997025463]},{"type":"Point","coordinates":[40078.55704305706,34296.43036466754]},{"type":"Point","coordinates":[39964.66642940134,34274.35383565253]},{"type":"Point","coordinates":[39188.64290822564,34196.31074536305]},{"type":"Point","coordinates":[39124.4925802681,34171.91154207975]},{"type":"Point","coordinates":[39188.64290822564,34196.31074536305]},{"type":"Point","coordinates":[39151.36758355507,34121.58584332652]},{"type":"Point","coordinates":[30373.00069639868,36421.46305146958]},{"type":"Point","coordinates":[30333.27660103234,36336.18803183409]},{"type":"Point","coordinates":[30088.35585566653,36489.71971565526]},{"type":"Point","coordinates":[29632.7857435024,36542.35940176504]},{"type":"Point","coordinates":[29924.80422824628,36550.02286176067]},{"type":"Point","coordinates":[30226.17379475736,36452.87228951303]},{"type":"Point","coordinates":[29625.0556637347,36505.53994324389]},{"type":"Point","coordinates":[29592.68463020231,37844.87243440807]},{"type":"Point","coordinates":[29032.1702427592,37885.80715826988]},{"type":"Point","coordinates":[28975.94543496441,37778.51995934697]},{"type":"Point","coordinates":[29164.84223101884,37756.46295317981]},{"type":"Point","coordinates":[29378.50159746969,37811.75084572293]},{"type":"Point","coordinates":[29181.72220124604,38185.96703445616]},{"type":"Point","coordinates":[30138.57298318087,36909.0875334718]},{"type":"Point","coordinates":[29965.20245211576,36754.11799935161]},{"type":"Point","coordinates":[28992.73230093549,37963.50101655995]},{"type":"Point","coordinates":[29049.94817319568,38191.45864554695]},{"type":"Point","coordinates":[29351.86658893975,38100.46809227467]},{"type":"Point","coordinates":[29736.57959344712,37771.78551457854]},{"type":"Point","coordinates":[28994.81731102069,38003.53551004788]},{"type":"Point","coordinates":[29207.69079944852,38218.63366507876]},{"type":"Point","coordinates":[29074.12251560429,37582.8456472399]},{"type":"Point","coordinates":[29600.33431827111,37890.80988088542]},{"type":"Point","coordinates":[29086.28316234024,38257.24038750513]},{"type":"Point","coordinates":[29129.75643174532,37573.17996012166]},{"type":"Point","coordinates":[29181.37045697669,37605.60269133373]},{"type":"Point","coordinates":[18833.13422402339,38400.37968019283]},{"type":"Point","coordinates":[18680.87170694697,38239.3136898614]},{"type":"Point","coordinates":[18676.55419099558,38354.99589567443]},{"type":"Point","coordinates":[18476.23867702673,38153.20139725733]},{"type":"Point","coordinates":[18857.18764586229,37512.04877278789]},{"type":"Point","coordinates":[18833.13422402339,38400.37968019283]},{"type":"Point","coordinates":[18817.1687100682,38361.18031064227]},{"type":"Point","coordinates":[19283.97635597408,36592.99440904709]},{"type":"Point","coordinates":[18693.2807630477,38044.36014924988]},{"type":"Point","coordinates":[18833.13422402339,38400.37968019283]},{"type":"Point","coordinates":[18190.42083097188,36773.16748785045]},{"type":"Point","coordinates":[17625.96415954874,36521.01889930933]},{"type":"Point","coordinates":[19842.62408673463,36831.0456841722]},{"type":"Point","coordinates":[19260.43149680564,36177.90929905013]},{"type":"Point","coordinates":[19012.08205479996,38443.15799667308]},{"type":"Point","coordinates":[19012.08205479996,38443.15799667308]},{"type":"Point","coordinates":[17824.75129163755,36645.39721791747]},{"type":"Point","coordinates":[17640.22071291844,36470.63611513702]},{"type":"Point","coordinates":[19401.03738958899,36201.59550970871]},{"type":"Point","coordinates":[18494.49048309358,36444.32418716075]},{"type":"Point","coordinates":[18974.36233560026,38264.44023279512]},{"type":"Point","coordinates":[18715.00400413692,36631.8646445405]},{"type":"Point","coordinates":[18411.08578271599,36743.99814113777]},{"type":"Point","coordinates":[26878.90134087032,28287.79662021813]},{"type":"Point","coordinates":[26591.26045405574,28653.82544042706]},{"type":"Point","coordinates":[26808.49628542547,29468.20164490907]},{"type":"Point","coordinates":[25644.05023681036,28493.59433189223]},{"type":"Point","coordinates":[26707.21437559702,28914.60146370745]},{"type":"Point","coordinates":[27150.27978479414,28217.39268473205]},{"type":"Point","coordinates":[25198.73164855451,29324.67897794084]},{"type":"Point","coordinates":[25406.6093155862,30116.05908179259]},{"type":"Point","coordinates":[28797.60780669308,28575.3093826275]},{"type":"Point","coordinates":[27326.45954797119,29289.19615357565]},{"type":"Point","coordinates":[26227.40569235001,30088.15735823824]},{"type":"Point","coordinates":[27096.78145654369,29393.49705268917]},{"type":"Point","coordinates":[27644.56043857467,29882.95861969461]},{"type":"Point","coordinates":[27722.42764158854,29885.23931226543]},{"type":"Point","coordinates":[25096.47411077598,28442.07105009299]},{"type":"Point","coordinates":[25024.13947143781,28462.79166424417]},{"type":"Point","coordinates":[21493.30664869321,39523.13978391352]},{"type":"Point","coordinates":[21089.52496587377,40146.58348888219]},{"type":"Point","coordinates":[20673.41552677985,40679.27212549573]},{"type":"Point","coordinates":[21365.05508752543,40291.41675954708]},{"type":"Point","coordinates":[20655.65209469596,39818.11448207985]},{"type":"Point","coordinates":[21276.84728194694,41202.55295821115]},{"type":"Point","coordinates":[21375.06440711367,40991.06964793906]},{"type":"Point","coordinates":[20529.61515103579,39767.72068036113]},{"type":"Point","coordinates":[20673.41552677985,40679.27212549573]},{"type":"Point","coordinates":[21155.89884037166,40320.6754876145]},{"type":"Point","coordinates":[19760.34441695132,40940.86877434922]},{"type":"Point","coordinates":[20967.15029701283,39800.71033090552]},{"type":"Point","coordinates":[21421.94597248192,39831.44250442328]},{"type":"Point","coordinates":[20259.59885716673,40766.99476563529]},{"type":"Point","coordinates":[19760.34441695132,40940.86877434922]},{"type":"Point","coordinates":[21072.26936993212,41108.45364086706]},{"type":"Point","coordinates":[20593.10509208083,40211.20284946528]},{"type":"Point","coordinates":[21099.53498158225,41178.93143023463]},{"type":"Point","coordinates":[21133.83547798281,41240.77340062917]},{"type":"Point","coordinates":[19676.89264984876,40790.67546752159]},{"type":"Point","coordinates":[19676.89264984876,40790.67546752159]},{"type":"Point","coordinates":[20550.01737627346,40105.06556151346]},{"type":"Point","coordinates":[20096.12998238799,40147.72961635509]},{"type":"Point","coordinates":[25100.24111273805,33339.64783699487]},{"type":"Point","coordinates":[25100.24111273805,33339.64783699487]},{"type":"Point","coordinates":[30086.33371225127,32348.26842884166]},{"type":"Point","coordinates":[30425.04495073596,32043.05080284093]},{"type":"Point","coordinates":[29003.55700971474,29339.04728061572]},{"type":"Point","coordinates":[28908.94528567632,28820.87459390435]},{"type":"Point","coordinates":[28899.77920190082,28918.08794194866]},{"type":"Point","coordinates":[28876.22281062172,28717.68071602919]},{"type":"Point","coordinates":[18371.67414375969,42947.87306284788]},{"type":"Point","coordinates":[18745.72918579466,42929.37290798747]},{"type":"Point","coordinates":[18869.25291817588,42453.69634934066]},{"type":"Point","coordinates":[18489.22921134395,42915.95281043636]},{"type":"Point","coordinates":[17588.49920600407,40316.8779150374]},{"type":"Point","coordinates":[18903.33273061742,42610.43604595309]},{"type":"Point","coordinates":[19047.12130185421,39896.35579739315]},{"type":"Point","coordinates":[18660.35031668707,42567.98589495571]},{"type":"Point","coordinates":[18706.36325149848,42558.75679323573]},{"type":"Point","coordinates":[18467.66151744174,42848.66387422656]},{"type":"Point","coordinates":[17405.08648443163,40176.89990137439]},{"type":"Point","coordinates":[18520.34273120869,42577.42145459052]},{"type":"Point","coordinates":[19534.58506082783,40043.26384753603]},{"type":"Point","coordinates":[17072.4554179631,40018.36313403165]},{"type":"Point","coordinates":[18379.99199758727,41507.31305336839]},{"type":"Point","coordinates":[17557.2148839557,40353.89351009729]},{"type":"Point","coordinates":[17783.9828903484,40288.54111948519]},{"type":"Point","coordinates":[17937.11866899627,41443.14898379954]},{"type":"Point","coordinates":[18105.21109931063,42501.27531937621]},{"type":"Point","coordinates":[18660.35031668707,42567.98589495571]},{"type":"Point","coordinates":[17649.40002375051,40442.92675393354]},{"type":"Point","coordinates":[17823.72015231357,40344.01316244039]},{"type":"Point","coordinates":[18766.96786679546,41859.85851594267]},{"type":"Point","coordinates":[18044.66184421364,42402.06961157232]},{"type":"Point","coordinates":[19444.71536126085,40306.89399034076]},{"type":"Point","coordinates":[17755.05695885365,40336.29016532301]},{"type":"Point","coordinates":[18787.32689957358,41790.24536179938]},{"type":"Point","coordinates":[17935.113293973,40767.18569607633]},{"type":"Point","coordinates":[18692.15385577912,41979.82902915432]},{"type":"Point","coordinates":[17785.96450505337,40176.08357385346]},{"type":"Point","coordinates":[18205.11623972945,41735.91215173203]},{"type":"Point","coordinates":[17915.85268626145,40797.87758290559]},{"type":"Point","coordinates":[18205.11623972945,41735.91215173203]},{"type":"Point","coordinates":[18205.11623972945,41735.91215173203]},{"type":"Point","coordinates":[20182.34273443312,31585.09142685554]},{"type":"Point","coordinates":[20063.29584881687,31962.44107833673]},{"type":"Point","coordinates":[20395.30917591023,33687.81521733194]},{"type":"Point","coordinates":[20918.96284968555,32638.11612404855]},{"type":"Point","coordinates":[20905.67577990913,32575.96999068226]},{"type":"Point","coordinates":[20778.82647393879,33052.08955154047]},{"type":"Point","coordinates":[20673.6866068902,33049.57718782027]},{"type":"Point","coordinates":[20918.96284968555,32638.11612404855]},{"type":"Point","coordinates":[20443.49105395502,33415.37460929251]},{"type":"Point","coordinates":[20555.97674885218,32729.68809502007]},{"type":"Point","coordinates":[20770.26239011997,32379.01576661718]},{"type":"Point","coordinates":[20617.73133554946,32691.95578437406]},{"type":"Point","coordinates":[20855.72882444367,32483.78360991177]},{"type":"Point","coordinates":[20497.65800200672,32600.25832234454]},{"type":"Point","coordinates":[20617.73133554946,32691.95578437406]}]],"container":"<table class=\"compact\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>resale_price<\/th>\n      <th>floor_area_sqm<\/th>\n      <th>storey_order<\/th>\n      <th>remaining_lease_mths<\/th>\n      <th>PROX_CBD<\/th>\n      <th>PROX_ELDERLYCARE<\/th>\n      <th>PROX_HAWKER<\/th>\n      <th>PROX_MRT<\/th>\n      <th>PROX_PARK<\/th>\n      <th>PROX_GOOD_PRISCH<\/th>\n      <th>PROX_MALL<\/th>\n      <th>PROX_CHAS<\/th>\n      <th>PROX_SUPERMARKET<\/th>\n      <th>WITHIN_350M_KINDERGARTEN<\/th>\n      <th>WITHIN_350M_CHILDCARE<\/th>\n      <th>WITHIN_350M_BUS<\/th>\n      <th>WITHIN_1KM_PRISCH<\/th>\n      <th>geometry<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"dom":"tip","columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"resale_price","targets":1},{"name":"floor_area_sqm","targets":2},{"name":"storey_order","targets":3},{"name":"remaining_lease_mths","targets":4},{"name":"PROX_CBD","targets":5},{"name":"PROX_ELDERLYCARE","targets":6},{"name":"PROX_HAWKER","targets":7},{"name":"PROX_MRT","targets":8},{"name":"PROX_PARK","targets":9},{"name":"PROX_GOOD_PRISCH","targets":10},{"name":"PROX_MALL","targets":11},{"name":"PROX_CHAS","targets":12},{"name":"PROX_SUPERMARKET","targets":13},{"name":"WITHIN_350M_KINDERGARTEN","targets":14},{"name":"WITHIN_350M_CHILDCARE","targets":15},{"name":"WITHIN_350M_BUS","targets":16},{"name":"WITHIN_1KM_PRISCH","targets":17},{"name":"geometry","targets":18}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="data-sampling" class="level1">
<h1>4 Data Sampling</h1>
<p>We can set a seed for reproducibility.</p>
<p>The entire data is split into training and test data sets with 65% and 35% respectively by using <code>initial_split()</code> from <strong>rsample</strong> package. <strong>rsample</strong> is one of the package of <strong>tinymodels</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>resale_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(mdata, </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">prop =</span> <span class="fl">6.5</span><span class="sc">/</span><span class="dv">10</span>,)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> <span class="fu">training</span>(resale_split)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> <span class="fu">testing</span>(resale_split)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(train_data, <span class="st">"data/aspatial/train_data.rds"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(test_data, <span class="st">"data/aspatial/test_data.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/aspatial/train_data.rds"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/aspatial/test_data.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="computing-correlation-matrix" class="level1">
<h1>5 Computing Correlation Matrix</h1>
<p>The code chunk below checks for any multicollinearity before using predictors in a predictive model. Multicollinearity refers to a situation where two or more predictors in a multiple regression model are highly correlated. If these variables are highly correlated, it can be difficult to disentangle the effect of each predictor on the response variable.</p>
<p>But first, we will need to remove the geometry column from our spatial data frame using the <code>st_drop_geometry()</code> function from the <strong>sf</strong> package. This is because the geometry column cannot be included in the correlation matrix.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>mdata_nogeo <span class="ot">&lt;-</span> mdata <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(mdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "resale_price"             "floor_area_sqm"          
 [3] "storey_order"             "remaining_lease_mths"    
 [5] "PROX_CBD"                 "PROX_ELDERLYCARE"        
 [7] "PROX_HAWKER"              "PROX_MRT"                
 [9] "PROX_PARK"                "PROX_GOOD_PRISCH"        
[11] "PROX_MALL"                "PROX_CHAS"               
[13] "PROX_SUPERMARKET"         "WITHIN_350M_KINDERGARTEN"
[15] "WITHIN_350M_CHILDCARE"    "WITHIN_350M_BUS"         
[17] "WITHIN_1KM_PRISCH"        "geometry"                </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">bg =</span> <span class="st">'#E4D5C9'</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>ggstatsplot<span class="sc">::</span><span class="fu">ggcorrmat</span>(</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mdata_nogeo[, <span class="dv">2</span><span class="sc">:</span><span class="dv">17</span>],</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">matrix.type =</span> <span class="st">"upper"</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"parametric"</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">colors =</span> <span class="fu">c</span>(<span class="st">"#E69F00"</span>, <span class="st">"white"</span>,<span class="st">"#d5695d"</span>),</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">tr =</span> <span class="fl">0.2</span>,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">partial =</span> <span class="cn">FALSE</span>,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">k =</span> 2L,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> <span class="fl">0.05</span>,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">conf.level =</span> <span class="fl">0.95</span>,</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">bf.prior =</span> <span class="fl">0.707</span>,</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">ggcorrplot.args =</span> <span class="fu">list</span>(</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">tl.cex =</span> <span class="dv">7</span>,</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch.cex =</span> <span class="dv">5</span>,</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">lab_size =</span> <span class="dv">3</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span> </span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="at">t =</span> <span class="fl">0.15</span>, <span class="at">r =</span> <span class="fl">0.15</span>, <span class="at">b =</span> <span class="fl">0.15</span>, <span class="at">l =</span> <span class="fl">0.15</span>, <span class="at">unit =</span> <span class="st">"cm"</span>)</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">"#E4D5C9"</span>,<span class="at">colour=</span><span class="st">"#E4D5C9"</span>),</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">"#E4D5C9"</span>,<span class="at">colour=</span><span class="st">"#E4D5C9"</span>),</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">"#E4D5C9"</span>,<span class="at">colour=</span><span class="st">"#E4D5C9"</span>)    </span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Hands-on_Ex08_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="lightbox light">
<p><strong>Observations</strong></p>
<p>The correlation matrix above indicates all correlation values are below 0.8, so there is no sign of high multicolinearity.</p>
</div>
</section>
<section id="non-spatial-multiple-linear-regression" class="level1">
<h1>6 Non-spatial multiple linear regression</h1>
<p>In this section, we will be building a non-spatial multiple linear regression model. This type of model is a statistical technique that uses several explanatory variables to predict the outcome of a response variable. The goal is to model the relationship between the explanatory and response variables.</p>
<p>We will use the <code>lm()</code> function to build the model. The formula inside the lm() function specifies the model structure. The response variable (in this case, <em>resale_price</em>) is on the left of the <em>~</em>, and the explanatory variables are on the right. The <em>+</em> operator is used to include multiple explanatory variables in the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>price_mlr <span class="ot">&lt;-</span> <span class="fu">lm</span>(resale_price <span class="sc">~</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>                  floor_area_sqm <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                  storey_order <span class="sc">+</span> </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                  remaining_lease_mths <span class="sc">+</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>                  PROX_CBD <span class="sc">+</span> </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>                  PROX_ELDERLYCARE <span class="sc">+</span> </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>                  PROX_HAWKER <span class="sc">+</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>                  PROX_MRT <span class="sc">+</span> </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>                  PROX_PARK <span class="sc">+</span> </span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>                  <span class="co">#PROX_GOOD_PRISCH + </span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>                  PROX_MALL <span class="sc">+</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>                  <span class="co">#PROX_CHAS + </span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>                  PROX_SUPERMARKET <span class="sc">+</span> </span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>                  WITHIN_350M_KINDERGARTEN <span class="sc">+</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>                  WITHIN_350M_CHILDCARE <span class="sc">+</span> </span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>                  WITHIN_350M_BUS <span class="sc">+</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>                  WITHIN_1KM_PRISCH,</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">data=</span>train_data)</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(price_mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = resale_price ~ floor_area_sqm + storey_order + remaining_lease_mths + 
    PROX_CBD + PROX_ELDERLYCARE + PROX_HAWKER + PROX_MRT + PROX_PARK + 
    PROX_MALL + PROX_SUPERMARKET + WITHIN_350M_KINDERGARTEN + 
    WITHIN_350M_CHILDCARE + WITHIN_350M_BUS + WITHIN_1KM_PRISCH, 
    data = train_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-205193  -39120   -1930   36545  472355 

Coefficients:
                           Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)              107601.073  10601.261  10.150  &lt; 2e-16 ***
floor_area_sqm             2780.698     90.579  30.699  &lt; 2e-16 ***
storey_order              14299.298    339.115  42.167  &lt; 2e-16 ***
remaining_lease_mths        344.490      4.592  75.027  &lt; 2e-16 ***
PROX_CBD                 -16930.196    201.254 -84.124  &lt; 2e-16 ***
PROX_ELDERLYCARE         -14441.025    994.867 -14.516  &lt; 2e-16 ***
PROX_HAWKER              -19265.648   1273.597 -15.127  &lt; 2e-16 ***
PROX_MRT                 -32564.272   1744.232 -18.670  &lt; 2e-16 ***
PROX_PARK                 -5712.625   1483.885  -3.850 0.000119 ***
PROX_MALL                -14717.388   2007.818  -7.330 2.47e-13 ***
PROX_SUPERMARKET         -26881.938   4189.624  -6.416 1.46e-10 ***
WITHIN_350M_KINDERGARTEN   8520.472    632.812  13.464  &lt; 2e-16 ***
WITHIN_350M_CHILDCARE     -4510.650    354.015 -12.741  &lt; 2e-16 ***
WITHIN_350M_BUS             813.493    222.574   3.655 0.000259 ***
WITHIN_1KM_PRISCH         -8010.834    491.512 -16.298  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 61650 on 10320 degrees of freedom
Multiple R-squared:  0.7373,    Adjusted R-squared:  0.737 
F-statistic:  2069 on 14 and 10320 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="gwr-prediction" class="level1">
<h1>7 GWR Prediction</h1>
<p>In this section, we will calibrate a model to predict HDB resale prices using the geographically weighted regression (GWR) method from the <strong>GWmodel</strong> package. GWR is a local version of spatial regression that generates parameters disaggregated by the spatial units of analysis. This allows for the identification of spatially varying relationships between the predictors and the dependent variable.</p>
<section id="converting-sf-data-frame-to-spatialpointdataframe" class="level2">
<h2 class="anchored" data-anchor-id="converting-sf-data-frame-to-spatialpointdataframe">7.1 Converting sf data frame to SPatialPointDataFrame</h2>
<p>First, we need to convert our sf data frame to a SpatialPointDataFrame. This is because the functions in the <strong>GWmodel</strong> package require data in this format. We use the <code>as_Spatial()</code> function from the <strong>sf</strong> package to perform this conversion.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>train_data_sp <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(train_data)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>train_data_sp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatialPointsDataFrame 
features    : 10335 
extent      : 11597.31, 42623.63, 28217.39, 48741.06  (xmin, xmax, ymin, ymax)
crs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs 
variables   : 17
names       : resale_price, floor_area_sqm, storey_order, remaining_lease_mths,          PROX_CBD,     PROX_ELDERLYCARE,        PROX_HAWKER,           PROX_MRT,          PROX_PARK,   PROX_GOOD_PRISCH,        PROX_MALL,            PROX_CHAS,     PROX_SUPERMARKET, WITHIN_350M_KINDERGARTEN, WITHIN_350M_CHILDCARE, ... 
min values  :       218000,             74,            1,                  555, 0.999393538715878, 1.98943787433087e-08, 0.0333358643817954, 0.0220407324774434, 0.0441643212802781, 0.0652540365486641,                0, 6.20621206270077e-09, 1.21715176356525e-07,                        0,                     0, ... 
max values  :      1186888,            133,           17,                 1164,  19.6500691667807,     3.30163731686804,   2.86763031236184,   2.13060636038504,   2.41313695915468,   10.6223726149914, 2.27100643784442,    0.808332738794272,     1.57131703651196,                        7,                    20, ... </code></pre>
</div>
</div>
</section>
<section id="compute-adaptive-bandwidth" class="level2">
<h2 class="anchored" data-anchor-id="compute-adaptive-bandwidth">7.2 Compute adaptive bandwidth</h2>
<p>Next, <code>bw.gwr()</code> of <strong>GWmodel</strong> package will be used to determine the optimal bandwidth to be used for the GWR model. The band.width is a parameter of the GWR model that determines the extent of the geographical area that influences a given location’s estimate</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(mdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "resale_price"             "floor_area_sqm"          
 [3] "storey_order"             "remaining_lease_mths"    
 [5] "PROX_CBD"                 "PROX_ELDERLYCARE"        
 [7] "PROX_HAWKER"              "PROX_MRT"                
 [9] "PROX_PARK"                "PROX_GOOD_PRISCH"        
[11] "PROX_MALL"                "PROX_CHAS"               
[13] "PROX_SUPERMARKET"         "WITHIN_350M_KINDERGARTEN"
[15] "WITHIN_350M_CHILDCARE"    "WITHIN_350M_BUS"         
[17] "WITHIN_1KM_PRISCH"        "geometry"                </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>bw_adaptive <span class="ot">&lt;-</span> <span class="fu">bw.gwr</span>(resale_price <span class="sc">~</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>                        floor_area_sqm <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>                        storey_order <span class="sc">+</span> </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>                        remaining_lease_mths <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>                        PROX_CBD <span class="sc">+</span> </span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>                        PROX_ELDERLYCARE <span class="sc">+</span> </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>                        PROX_HAWKER <span class="sc">+</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>                        PROX_MRT <span class="sc">+</span> </span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>                        PROX_PARK <span class="sc">+</span> </span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>                        <span class="co">#PROX_GOOD_PRISCH +</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>                        PROX_MALL <span class="sc">+</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>                        <span class="co">#PROX_CHAS +</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>                        PROX_SUPERMARKET <span class="sc">+</span> </span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>                        WITHIN_350M_KINDERGARTEN <span class="sc">+</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>                        WITHIN_350M_CHILDCARE <span class="sc">+</span> </span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>                        WITHIN_350M_BUS <span class="sc">+</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>                        WITHIN_1KM_PRISCH,</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data=</span>train_data_sp,</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>                      <span class="at">approach=</span><span class="st">"CV"</span>,</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>                      <span class="at">kernel=</span><span class="st">"gaussian"</span>,</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>                      <span class="at">adaptive=</span><span class="cn">TRUE</span>,</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>                      <span class="at">longlat=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="lightbox light">
<p><strong>Observations</strong></p>
<p>In the adaptive approach, the bandwidth is not a fixed distance but is determined based on the number of nearest neighbor points. This approach is particularly useful in areas where the density of data points varies.</p>
<p>In regions where data points are densely clustered, the adaptive bandwidth will be smaller, allowing the model to capture local variations more accurately. Conversely, in regions where data points are sparse, the adaptive bandwidth will be larger, ensuring that the model has enough data points to make reliable predictions.</p>
<p>The result from the <code>bw.gwr()</code> function indicates that the optimal bandwidth for this dataset is 40 neighbor points. This means that when estimating the parameters for a given location, the model will consider the 40 nearest neighbors.</p>
</div>
</section>
<section id="construct-adaptive-bandwidth-gwr-model" class="level2">
<h2 class="anchored" data-anchor-id="construct-adaptive-bandwidth-gwr-model">7.3 Construct adaptive bandwidth GWR model</h2>
<p>Next, let us call the save bandwidth by using the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(bw_adaptive, <span class="st">"data/aspatial/bw_adaptive.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>bw_adaptive <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/aspatial/bw_adaptive.rds"</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>bw_adaptive</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 40</code></pre>
</div>
</div>
<p>The code chunk below calibrates gwr-based hedonic pricing model using adaptive bandwidth and Gaussian kernel.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>gwr_adaptive <span class="ot">&lt;-</span> <span class="fu">gwr.basic</span>(<span class="at">formula =</span> resale_price <span class="sc">~</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>                            floor_area_sqm <span class="sc">+</span> </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>                            storey_order <span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>                            remaining_lease_mths <span class="sc">+</span> </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>                            PROX_CBD <span class="sc">+</span> </span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>                            PROX_ELDERLYCARE <span class="sc">+</span> </span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>                            PROX_HAWKER <span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>                            PROX_MRT <span class="sc">+</span> </span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>                            PROX_PARK <span class="sc">+</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>                            <span class="co">#PROX_GOOD_PRISCH +</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>                            PROX_MALL <span class="sc">+</span> </span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>                            <span class="co">#PROX_CHAS +</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>                            PROX_SUPERMARKET <span class="sc">+</span> </span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>                            WITHIN_350M_KINDERGARTEN <span class="sc">+</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>                            WITHIN_350M_CHILDCARE <span class="sc">+</span> </span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>                            WITHIN_350M_BUS <span class="sc">+</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>                            WITHIN_1KM_PRISCH,</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> train_data_sp,</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>                          <span class="at">bw =</span> bw_adaptive, </span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>                          <span class="at">kernel =</span> <span class="st">'gaussian'</span>, </span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>                          <span class="at">adaptive =</span> <span class="cn">TRUE</span>,</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>                          <span class="at">longlat =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The code chunk below will be used to save the model in rds format for future use.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwr_adaptive, <span class="st">"data/aspatial/gwr_adaptive.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="retrieve-gwr-output-object" class="level2">
<h2 class="anchored" data-anchor-id="retrieve-gwr-output-object">7.4 Retrieve GWR output object</h2>
<p>The code chunk below will be used to retrieve the save gwr model object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>gwr_adaptive <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/aspatial/gwr_adaptive.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>gwr_adaptive</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   ***********************************************************************
   *                       Package   GWmodel                             *
   ***********************************************************************
   Program starts at: 2024-09-01 00:05:34.593548 
   Call:
   gwr.basic(formula = resale_price ~ floor_area_sqm + storey_order + 
    remaining_lease_mths + PROX_CBD + PROX_ELDERLYCARE + PROX_HAWKER + 
    PROX_MRT + PROX_PARK + PROX_MALL + PROX_SUPERMARKET + WITHIN_350M_KINDERGARTEN + 
    WITHIN_350M_CHILDCARE + WITHIN_350M_BUS + WITHIN_1KM_PRISCH, 
    data = train_data_sp, bw = bw_adaptive, kernel = "gaussian", 
    adaptive = TRUE, longlat = FALSE)

   Dependent (y) variable:  resale_price
   Independent variables:  floor_area_sqm storey_order remaining_lease_mths PROX_CBD PROX_ELDERLYCARE PROX_HAWKER PROX_MRT PROX_PARK PROX_MALL PROX_SUPERMARKET WITHIN_350M_KINDERGARTEN WITHIN_350M_CHILDCARE WITHIN_350M_BUS WITHIN_1KM_PRISCH
   Number of data points: 10335
   ***********************************************************************
   *                    Results of Global Regression                     *
   ***********************************************************************

   Call:
    lm(formula = formula, data = data)

   Residuals:
    Min      1Q  Median      3Q     Max 
-205193  -39120   -1930   36545  472355 

   Coefficients:
                              Estimate Std. Error t value Pr(&gt;|t|)    
   (Intercept)              107601.073  10601.261  10.150  &lt; 2e-16 ***
   floor_area_sqm             2780.698     90.579  30.699  &lt; 2e-16 ***
   storey_order              14299.298    339.115  42.167  &lt; 2e-16 ***
   remaining_lease_mths        344.490      4.592  75.027  &lt; 2e-16 ***
   PROX_CBD                 -16930.196    201.254 -84.124  &lt; 2e-16 ***
   PROX_ELDERLYCARE         -14441.025    994.867 -14.516  &lt; 2e-16 ***
   PROX_HAWKER              -19265.648   1273.597 -15.127  &lt; 2e-16 ***
   PROX_MRT                 -32564.272   1744.232 -18.670  &lt; 2e-16 ***
   PROX_PARK                 -5712.625   1483.885  -3.850 0.000119 ***
   PROX_MALL                -14717.388   2007.818  -7.330 2.47e-13 ***
   PROX_SUPERMARKET         -26881.938   4189.624  -6.416 1.46e-10 ***
   WITHIN_350M_KINDERGARTEN   8520.472    632.812  13.464  &lt; 2e-16 ***
   WITHIN_350M_CHILDCARE     -4510.650    354.015 -12.741  &lt; 2e-16 ***
   WITHIN_350M_BUS             813.493    222.574   3.655 0.000259 ***
   WITHIN_1KM_PRISCH         -8010.834    491.512 -16.298  &lt; 2e-16 ***

   ---Significance stars
   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 
   Residual standard error: 61650 on 10320 degrees of freedom
   Multiple R-squared: 0.7373
   Adjusted R-squared: 0.737 
   F-statistic:  2069 on 14 and 10320 DF,  p-value: &lt; 2.2e-16 
   ***Extra Diagnostic information
   Residual sum of squares: 3.922202e+13
   Sigma(hat): 61610.08
   AIC:  257320.2
   AICc:  257320.3
   BIC:  247249
   ***********************************************************************
   *          Results of Geographically Weighted Regression              *
   ***********************************************************************

   *********************Model calibration information*********************
   Kernel function: gaussian 
   Adaptive bandwidth: 40 (number of nearest neighbours)
   Regression points: the same locations as observations are used.
   Distance metric: Euclidean distance metric is used.

   ****************Summary of GWR coefficient estimates:******************
                                   Min.     1st Qu.      Median     3rd Qu.
   Intercept                -3.2478e+08 -4.7727e+05 -8.3004e+03  5.5025e+05
   floor_area_sqm           -2.8714e+04  1.4475e+03  2.3011e+03  3.3900e+03
   storey_order              3.3186e+03  8.5899e+03  1.0826e+04  1.3397e+04
   remaining_lease_mths     -1.4431e+03  2.6063e+02  3.9048e+02  5.2865e+02
   PROX_CBD                 -1.0837e+07 -5.7697e+04 -1.3787e+04  2.6552e+04
   PROX_ELDERLYCARE         -3.2195e+07 -4.0643e+04  1.0562e+04  6.1054e+04
   PROX_HAWKER              -2.3985e+08 -5.1365e+04  3.0026e+03  6.4287e+04
   PROX_MRT                 -1.1632e+07 -1.0488e+05 -4.9373e+04  5.1037e+03
   PROX_PARK                -6.5961e+06 -4.8671e+04 -8.8128e+02  5.3498e+04
   PROX_MALL                -1.8112e+07 -7.4238e+04 -1.3982e+04  4.9779e+04
   PROX_SUPERMARKET         -4.5761e+06 -6.3461e+04 -1.7429e+04  3.5616e+04
   WITHIN_350M_KINDERGARTEN -4.1823e+05 -6.0040e+03  9.0209e+01  4.7127e+03
   WITHIN_350M_CHILDCARE    -1.0273e+05 -2.2375e+03  2.6668e+02  2.6388e+03
   WITHIN_350M_BUS          -1.1757e+05 -1.4719e+03  1.1626e+02  1.7584e+03
   WITHIN_1KM_PRISCH        -6.6465e+05 -5.5959e+03  2.6916e+02  5.7500e+03
                                  Max.
   Intercept                1.6493e+08
   floor_area_sqm           5.0907e+04
   storey_order             2.9537e+04
   remaining_lease_mths     1.8119e+03
   PROX_CBD                 2.2411e+07
   PROX_ELDERLYCARE         8.2444e+07
   PROX_HAWKER              5.9654e+06
   PROX_MRT                 2.0189e+08
   PROX_PARK                1.5188e+07
   PROX_MALL                1.0443e+07
   PROX_SUPERMARKET         3.8330e+06
   WITHIN_350M_KINDERGARTEN 6.6799e+05
   WITHIN_350M_CHILDCARE    1.0802e+05
   WITHIN_350M_BUS          3.7313e+04
   WITHIN_1KM_PRISCH        5.0231e+05
   ************************Diagnostic information*************************
   Number of data points: 10335 
   Effective number of parameters (2trace(S) - trace(S'S)): 1730.101 
   Effective degrees of freedom (n-2trace(S) + trace(S'S)): 8604.899 
   AICc (GWR book, Fotheringham, et al. 2002, p. 61, eq 2.33): 238871.9 
   AIC (GWR book, Fotheringham, et al. 2002,GWR p. 96, eq. 4.22): 237036.9 
   BIC (GWR book, Fotheringham, et al. 2002,GWR p. 61, eq. 2.34): 238209.1 
   Residual sum of squares: 4.829191e+12 
   R-square value:  0.967657 
   Adjusted R-square value:  0.9611534 

   ***********************************************************************
   Program stops at: 2024-09-01 00:07:49.648943 </code></pre>
</div>
</div>
</section>
<section id="convert-test-data-from-sf-data-frame-to-spatialpointdataframe" class="level2">
<h2 class="anchored" data-anchor-id="convert-test-data-from-sf-data-frame-to-spatialpointdataframe">7.5 Convert test data from sf data frame to SpatialPointDataFrame</h2>
<p>We need to convert our test data from an sf data frame to a SpatialPointDataFrame. This is because the functions in the <strong>GWmodel</strong> package require data in this format. We use the <code>as_Spatial()</code> function from the <strong>sf</strong> package to perform this conversion.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>test_data_sp <span class="ot">&lt;-</span> test_data <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_Spatial</span>()</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>test_data_sp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatialPointsDataFrame 
features    : 5566 
extent      : 11597.31, 42623.63, 28287.8, 48669.59  (xmin, xmax, ymin, ymax)
crs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs 
variables   : 17
names       : resale_price, floor_area_sqm, storey_order, remaining_lease_mths,         PROX_CBD,     PROX_ELDERLYCARE,        PROX_HAWKER,           PROX_MRT,          PROX_PARK,   PROX_GOOD_PRISCH,        PROX_MALL,            PROX_CHAS,     PROX_SUPERMARKET, WITHIN_350M_KINDERGARTEN, WITHIN_350M_CHILDCARE, ... 
min values  :       230888,             74,            1,                  546, 1.00583660772922, 3.34897933104965e-07, 0.0474019664161957, 0.0414043955932523, 0.0502664084494264, 0.0907500295577619,                0, 4.55547870890763e-09, 1.21715176356525e-07,                        0,                     0, ... 
max values  :      1050000,            138,           14,                 1151,  19.632402730488,     3.30163731686804,   2.83106651960209,   2.13060636038504,   2.41313695915468,   10.6169590126272, 2.26056404492346,     0.79249074802552,     1.53786629004208,                        7,                    16, ... </code></pre>
</div>
</div>
</section>
<section id="computing-adaptive-bandwidth-for-test-data" class="level2">
<h2 class="anchored" data-anchor-id="computing-adaptive-bandwidth-for-test-data">7.6 Computing adaptive bandwidth for test data</h2>
<p>Next, similar to the process performed for training data, we use the <code>bw.gwr()</code> function from the GWmodel package to determine the optimal bandwidth for our GWR model on the test data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>gwr_bw_test_adaptive <span class="ot">&lt;-</span> <span class="fu">bw.gwr</span>(resale_price <span class="sc">~</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>                                 floor_area_sqm <span class="sc">+</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>                                 storey_order <span class="sc">+</span> </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>                                 remaining_lease_mths <span class="sc">+</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>                                 PROX_CBD <span class="sc">+</span> </span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>                                 PROX_ELDERLYCARE <span class="sc">+</span> </span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>                                 PROX_HAWKER <span class="sc">+</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>                                 PROX_MRT <span class="sc">+</span> </span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>                                 PROX_PARK <span class="sc">+</span> </span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>                                 <span class="co">#PROX_GOOD_PRISCH +</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>                                 PROX_MALL <span class="sc">+</span> </span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>                                 <span class="co">#PROX_CHAS +</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>                                 PROX_SUPERMARKET <span class="sc">+</span> </span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>                                 WITHIN_350M_KINDERGARTEN <span class="sc">+</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>                                 WITHIN_350M_CHILDCARE <span class="sc">+</span> </span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>                                 WITHIN_350M_BUS <span class="sc">+</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>                                 WITHIN_1KM_PRISCH,</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>                               <span class="at">data =</span> test_data_sp,</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>                               <span class="at">approach =</span> <span class="st">"CV"</span>,</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>                               <span class="at">kernel =</span> <span class="st">"gaussian"</span>,</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>                               <span class="at">adaptive =</span> <span class="cn">TRUE</span>,</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>                               <span class="at">longlat =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwr_bw_test_adaptive, <span class="st">"data/aspatial/gwr_bw_test_adaptive.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>gwr_bw_test_adaptive <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/aspatial/gwr_bw_test_adaptive.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="computing-predicted-values-of-the-test-data" class="level2">
<h2 class="anchored" data-anchor-id="computing-predicted-values-of-the-test-data">7.7 Computing predicted values of the test data</h2>
<p>Finally, we use the <code>gwr.predict()</code> function from the <strong>GWmodel</strong> package to compute the predicted values of the test data based on our GWR model. We specify our formula, training data, test data, bandwidth, kernel type, and set <code>adaptive=TRUE</code> and <code>longlat=FALSE</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>gwr_pred <span class="ot">&lt;-</span> <span class="fu">gwr.predict</span>(<span class="at">formula =</span> resale_price <span class="sc">~</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>                          floor_area_sqm <span class="sc">+</span> storey_order <span class="sc">+</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>                          remaining_lease_mths <span class="sc">+</span> PROX_CBD <span class="sc">+</span> </span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>                          PROX_ELDERLYCARE <span class="sc">+</span> PROX_HAWKER <span class="sc">+</span> </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>                          PROX_MRT <span class="sc">+</span> PROX_PARK <span class="sc">+</span> PROX_MALL <span class="sc">+</span> </span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>                          PROX_SUPERMARKET <span class="sc">+</span> WITHIN_350M_KINDERGARTEN <span class="sc">+</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>                          WITHIN_350M_CHILDCARE <span class="sc">+</span> WITHIN_350M_BUS <span class="sc">+</span> </span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>                          WITHIN_1KM_PRISCH, </span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data=</span>train_data_sp, </span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>                        <span class="at">predictdata =</span> test_data_sp, </span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>                        <span class="at">bw=</span><span class="dv">40</span>, </span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>                        <span class="at">kernel =</span> <span class="st">'gaussian'</span>, </span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>                        <span class="at">adaptive=</span><span class="cn">TRUE</span>, </span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>                        <span class="at">longlat =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="preparing-coordinates-data" class="level1">
<h1>8 Preparing coordinates data</h1>
<section id="extracting-coordinates-data" class="level2">
<h2 class="anchored" data-anchor-id="extracting-coordinates-data">8.1 Extracting coordinates data</h2>
<p>The code chunk below extract the x, y coordinates of the full, training and test data sets using <code>st_coordinates()</code> function from the <strong>sf</strong> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(mdata)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>coords_train <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(train_data)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>coords_test <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(test_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Save the output into rds for future use.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>coords_train <span class="ot">&lt;-</span> <span class="fu">write_rds</span>(coords_train, <span class="st">"data/geospatial/coords_train.rds"</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>coords_test <span class="ot">&lt;-</span> <span class="fu">write_rds</span>(coords_test, <span class="st">"data/geospatial/coords_test.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>coords_train <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/geospatial/coords_train.rds"</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>coords_test <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/geospatial/coords_test.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="dropping-geometry-field" class="level2">
<h2 class="anchored" data-anchor-id="dropping-geometry-field">8.2 Dropping geometry field</h2>
<p>Next, we drop the geometry column from the sf data frame. This is because the geometry column is not needed for our upcoming analysis. We use the <code>st_drop_geometry()</code> function from the <strong>sf</strong> package to perform this operation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> train_data <span class="sc">%&gt;%</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="calibrating-random-forest-model" class="level1">
<h1>9 Calibrating Random Forest Model</h1>
<p>In this section, we will calibrate a model to predict HDB resale prices using the random forest function from the <strong>ranger</strong> package. Random forest is a popular machine learning algorithm that can be used for both regression and classification tasks. It works by creating a multitude of decision trees at training time and outputting the mean prediction of the individual trees for regression tasks.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>rf <span class="ot">&lt;-</span> <span class="fu">ranger</span>(resale_price <span class="sc">~</span> floor_area_sqm <span class="sc">+</span> storey_order <span class="sc">+</span> </span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>               remaining_lease_mths <span class="sc">+</span> PROX_CBD <span class="sc">+</span> PROX_ELDERLYCARE <span class="sc">+</span> </span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>               PROX_HAWKER <span class="sc">+</span> PROX_MRT <span class="sc">+</span> PROX_PARK <span class="sc">+</span> PROX_MALL <span class="sc">+</span> </span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>               PROX_SUPERMARKET <span class="sc">+</span> WITHIN_350M_KINDERGARTEN <span class="sc">+</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>               WITHIN_350M_CHILDCARE <span class="sc">+</span> WITHIN_350M_BUS <span class="sc">+</span> </span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>               WITHIN_1KM_PRISCH,</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">data=</span>train_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>After fitting the model, we save it as an RDS file using the <code>write_rds()</code> function. This allows us to easily load the model in future R sessions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(rf, <span class="st">"data/aspatial/rf.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>rf <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/aspatial/rf.rds"</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>rf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Ranger result

Call:
 ranger(resale_price ~ floor_area_sqm + storey_order + remaining_lease_mths +      PROX_CBD + PROX_ELDERLYCARE + PROX_HAWKER + PROX_MRT + PROX_PARK +      PROX_MALL + PROX_SUPERMARKET + WITHIN_350M_KINDERGARTEN +      WITHIN_350M_CHILDCARE + WITHIN_350M_BUS + WITHIN_1KM_PRISCH,      data = train_data) 

Type:                             Regression 
Number of trees:                  500 
Sample size:                      10335 
Number of independent variables:  14 
Mtry:                             3 
Target node size:                 5 
Variable importance mode:         none 
Splitrule:                        variance 
OOB prediction error (MSE):       728602496 
R squared (OOB):                  0.9495728 </code></pre>
</div>
</div>
</section>
<section id="calibrating-geographical-random-forest-model" class="level1">
<h1>10 Calibrating Geographical Random Forest Model</h1>
<section id="calibrating-using-training-data" class="level2">
<h2 class="anchored" data-anchor-id="calibrating-using-training-data">10.1 Calibrating using training data</h2>
<p>In this section, we will calibrate a model to predict HDB resale prices using the <code>grf()</code> function from the <strong>SpatialML</strong> package. This function fits a geographically weighted random forest model, which is a type of model that takes into account the spatial relationships between observations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>gwRF_adaptive <span class="ot">&lt;-</span> <span class="fu">grf</span>(<span class="at">formula =</span> resale_price <span class="sc">~</span> floor_area_sqm <span class="sc">+</span> storey_order <span class="sc">+</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>                       remaining_lease_mths <span class="sc">+</span> PROX_CBD <span class="sc">+</span> PROX_ELDERLYCARE <span class="sc">+</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>                       PROX_HAWKER <span class="sc">+</span> PROX_MRT <span class="sc">+</span> PROX_PARK <span class="sc">+</span> PROX_MALL <span class="sc">+</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>                       PROX_SUPERMARKET <span class="sc">+</span> WITHIN_350M_KINDERGARTEN <span class="sc">+</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>                       WITHIN_350M_CHILDCARE <span class="sc">+</span> WITHIN_350M_BUS <span class="sc">+</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>                       WITHIN_1KM_PRISCH,</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">dframe=</span>train_data, </span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">bw=</span><span class="dv">55</span>,</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">kernel=</span><span class="st">"adaptive"</span>,</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">coords=</span>coords_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_adaptive, <span class="st">"data/aspatial/gwRF_adaptive.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>gwRF_adaptive <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/aspatial/gwRF_adaptive.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="predicting-by-using-test-data" class="level2">
<h2 class="anchored" data-anchor-id="predicting-by-using-test-data">10.2 Predicting by using test data</h2>
<section id="preparing-the-test-data" class="level3">
<h3 class="anchored" data-anchor-id="preparing-the-test-data">10.2.1 Preparing the test data</h3>
<p>First, combine the test data with the corresponding coordinates data. None of the rows from our data sets were sorted, so using <code>cbind()</code> is sufficient, <code>st_drop_geometry()</code> function is used to remove the geometry column.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(test_data, coords_test) <span class="sc">%&gt;%</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="predicting-with-test-data" class="level3">
<h3 class="anchored" data-anchor-id="predicting-with-test-data">10.2.2 Predicting with test data</h3>
<p>The function <code>predict.grf()</code> of <strong>SpatialML</strong> will be used to predict the resale value which uses the test data and <em>gwRF_adaptive</em> model calibrated earlier.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>gwRF_pred <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive, </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>                           test_data, </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">y.var.name=</span><span class="st">"Y"</span>, </span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">local.w=</span><span class="dv">1</span>,</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">global.w=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>GRF_pred <span class="ot">&lt;-</span> <span class="fu">write_rds</span>(gwRF_pred, <span class="st">"data/aspatial/GRF_pred.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="converting-predictive-output-into-data-frame" class="level3">
<h3 class="anchored" data-anchor-id="converting-predictive-output-into-data-frame">10.2.3 Converting predictive output into data frame</h3>
<p>The output of the <code>predict.grf()</code> function is a vector of predicted values. For further visualization and analysis, it’s useful to convert it into a data frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>GRF_pred <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/aspatial/GRF_pred.rds"</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>GRF_pred_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(GRF_pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We then use <em>cbind()</em> to append the predicted values into the test data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>test_data_p <span class="ot">&lt;-</span> <span class="fu">cbind</span>(test_data, GRF_pred_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(test_data_p, <span class="st">"data/aspatial/test_data_p.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="calculating-root-mean-square-error-rmse" class="level2">
<h2 class="anchored" data-anchor-id="calculating-root-mean-square-error-rmse">10.3 Calculating Root Mean Square Error (RMSE)</h2>
<p>RMSE measures how far the predicted values are from the observed values in a regression analysis. The Metrics package contains the <code>rmse()</code> function which can be used to compute RMSE.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rmse</span>(test_data_p<span class="sc">$</span>resale_price, </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>     test_data_p<span class="sc">$</span>GRF_pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 27302.9</code></pre>
</div>
</div>
<p>The lower the RMSE value, the better the predictive model is.</p>
</section>
<section id="visualising-predicted-values" class="level2">
<h2 class="anchored" data-anchor-id="visualising-predicted-values">10.4 Visualising Predicted Values</h2>
<p>The individual prices can be plotted in the scatterplot, where plots further away from the regression line were not as well predicted than plot prices closer to the regression line.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>test_data_p <span class="ot">&lt;-</span> test_data_p[, <span class="sc">!</span>(<span class="fu">names</span>(test_data_p) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"X.1"</span>, <span class="st">"Y.1"</span>))]</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> test_data_p,</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> GRF_pred,</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> resale_price)) <span class="sc">+</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>) <span class="sc">+</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background=</span><span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">'grey96'</span>),</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background=</span><span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">"#E4D5C9"</span>,<span class="at">colour=</span><span class="st">"#E4D5C9"</span>))  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Hands-on_Ex08_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="reference" class="level1">
<h1>11 Reference</h1>
<p>Kam, T. S. Geographically Weighted Predictive Models. <em>R for Geospatial Data Science and Analytics.</em> <a href="https://r4gdsa.netlify.app/chap14.html" class="uri">https://r4gdsa.netlify.app/chap14.html</a></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>